% $HeadURL$

\chapter{Concepts and Glyphs}
\label{chp:glyphs}


\section{Introduction}

Although ultimately defined by its glyphs, \SBGNPDLone these glyphs
represent concepts that are related to varying degrees and ultimately
can be organised hierarchically. This provides us with a useful way or
organising the glyphs and thinking about \PD{}.  Therefore in this
chapter we describe the conceptual structure of \SBGNPDLone and place
each glyph within this structure. For each glyph or concept we describe its
physical appearance and define syntax and other usage rules. An
overview of this hierarchy is provided in figures
\ref{fig:sbgn_node_tax} and \ref{fig:sbgn_edge_tax}.

\begin{figure}[htb]
\begin{center}
\includegraphics[width=1.0\linewidth]{images/sbgnumloverview}
\caption{Organisation of the node glyphs within SBGN \PDl. All UML classes (boxes) correspond to \PD node glyphs except those with italicised names, which are organisational groupings. They correspond to the groupings used elsewhere in this document.}
\label{fig:sbgn_node_tax}
\end{center}
\end{figure}


\section{Definitions}

\subsection{SBGNElement}
\label{defn:SBGNElement}

All the glyphs in \SBGNPDLone inherit from
\sbgnclass{SBGNElement}. This is an abstract or conceptual class that
helps organise \PD conceptually. \sbgnclass{SBGNElement} (figure
\ref{fig:mapuml}) has a single attribute \attrib{id} that is an
identifying attribute. This means that all SBGN elements defined here,
which ultimately extend \sbgnclass{SBGNBase}, can all be uniquely
identified from each other. This makes sense if you think that a glyph
drawn on a map is distinct from another glyph drawn on the map. The
\attrib{id} attribute reflects this and is not shown explicitly in a
\PDm.


\subsubsection{Generalisation}

None

\subsubsection{Attributes}

\begin{attributes}
  \attitem{id}{identifier} uniquely identified all SBGN elements in
  the same namespace.
\end{attributes}

\subsubsection{Changes from Previous Version}

Not defined in the previous version.

\subsection{Map}
\label{defn:Map}\label{sec:map}


\begin{figure}[h!]
  \centering
  \includegraphics[width=0.75\textwidth]{images/mapuml}
  \caption{UML definition of Map and \sbgnclass{SBGNElement}.}
  \label{fig:mapuml}
\end{figure}

The \sbgnclass{Map} (figure \ref{fig:mapuml}) is a container that
holds all the glyphs drawn in a \PDm. A \sbgnclass{Map} may contain a
\classref{SubmapNode} in which case some of the detail is summarised
in another \PDm. In this case the former is referred to as the ``Main
Map'' and the latter the ``Submap''. A Main Map shares the same
namespace as its Submap and uses the \classref{CrossReference}
identify the interface between both maps. The details of Main Map and
Submap linking semantics are described in more detail in section
\ref{sec:submapsemanctics}.


\subsubsection{Generalisation}

\begin{itemize}
\item \classref{SBGNElement}
\end{itemize}

\subsubsection{Attributes}

No additional attributes

\subsubsection{Associations}

\begin{attributes}
\associtem{elements}{SBGNGlyph}{*} The collection of glyphs held by the map. 
\end{attributes}

\subsubsection{Rules and Constraints}

\begin{itemize}
\item A map is valid if it is empty (although not very useful).
\end{itemize}

\subsubsection{Notation}

The map is the canvas upon which the \PDl is drawn. It's only visible
feature is its colour. It can take any pattern or colour (or be
transparent for that matter), but as SBGN is `colour blind' this does
not convey any meaning in itself.

\subsubsection{Changes from Previous Version}

Not defined explicitly in previous versions.

\subsection{SBGNGlyph}
\label{defn:SBGNGlyph}

\begin{figure}[htb]
  \centering
  \includegraphics[width=0.75\textwidth]{images/glyphauxuml}
\caption{UML definition of the Auxiliary Unit and its subclasses.}
  \label{fig:glyphauxuml}
\end{figure}

 Glyphs are the fundamental building blocks of the \PDl and are the
only elements that can be drawn directly on a map (\sbgnclass{Map}).

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{SBGNElement}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

\begin{attributes}
\associtem{owning\_map}{Map}{1} The map that contains this class.
\end{attributes}

\subsubsection{Rules and Constraints}

No additional rules and constraints.

\subsubsection{Changes from Previous Version}

Not defined in  previous version.


\subsection{AuxiliaryUnit}

\begin{figure}[htb]
  \centering
  \includegraphics[width=0.75\textwidth]{images/auxiliaryunituml}
\caption{UML definition of the Auxiliary Unit and its subclasses.}
  \label{fig:auxiliaryunituml}
\end{figure}

 The \sbgnclass{AuxiliaryUnit} (figure \ref{fig:auxiliaryunituml}) represents symbols that may be used to
adorn glyphs. In doing so they change the meaning of the glyph and/or provide
additional information about it.

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{SBGNElement}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

No additional associations.

\subsubsection{Rules and Constraints}

No additional rules and constraints.

\subsubsection{Changes from Previous Version}

Not defined in previous version.


\subsection{SBGNNode}
\label{defn:SBGNNode}

The \sbgnclass{SBGNNode} (figure \ref{fig:glyphauxuml}) represents the nodes in the graph structure
that is the core representation within \PDl. The nodes are connected
to glyphs descended from \sbgnclass{SBGNArc} for form a direct graph.

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{SBGNGlyph}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

\begin{attributes}
  \associtem{out\_arcs}{SBGNArc}{*} The arcs that are leaving this node.
  \associtem{in\_arcs}{SBGNArc}{*} The arcs that are entering this node.
\end{attributes}
 
\subsubsection{Rules and Constraints}

No additional rules and constraints.

\subsubsection{Changes from Previous Version}

Not defined in the previous version.

\subsection{SBGNArc}

The \sbgnclass{SBGNArc} (figure \ref{fig:glyphauxuml}) represents the arcs (also know as edges) in
the graph structure that is the core representation within \PDl. The
arc is connected to two nodes descended from \sbgnclass{SBGNNode}, one
at each end. As the arc has a direction (directed arc) these nodes are
by convention designated the \emph{out node} to indicate the arc is
leaving the node and \emph{in node} to indicate that it is entering
the node.

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{SBGNGlyph}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

\begin{attributes}
  \associtem{out\_node}{SBGNNode}{1} The node that this arc is leaving.
  \associtem{in\_node}{SBGNNode}{1} The node that this arc is entering.
\end{attributes}

\subsubsection{Rules and Constraints}

No additional rules and constraints.

\subsubsection{Changes from Previous Version}

Not defined in the previous version.


\subsection{EntityPoolNode}
\label{sec:EPNs}\label{defn:EntityPoolNode}\label{sec:EPN}

An entity pool is a population of entities that cannot be
distinguished from each other, when it comes to the \SBGNPDLone
map. For instance all the molecular entities that fulfill the same
role in a given process form an entity pool. As a result, an entity
pool can represent different granularity levels, such as all the
proteins, all the instances of a given protein, only certain forms of
a given protein. To belong to a different compartment is sufficient to
belong to different entity pools. Calcium ions in the endoplasmic
reticulum and calcium ions in the cytosol belong to different entity
pools when it comes to representing calcium release from the
endoplasmic reticulum.

% The \PD contains five glyph types representing classes of material
% entities: \glyph{unspecified entity} (\sect{unspecifiedEntity}),
% \glyph{simple chemical} (\sect{simpleChemical}), \glyph{macromolecule}
% (\sect{macromolecule}), \glyph{nucleic acid feature} (\sect{genetic})
% and \glyph{complex} (\sect{complex}).  (Specific types of
% macromolecules, such as protein, RNA, DNA, polysaccharide, and
% specific simple chemicals are not defined by \PD but may be part of
% future levels of SBGN.)  In addition to the material entities, \PD
% represents a conceptual entities: \glyph{perturbing agent} (\sect{perturbing
%   agent}).

\begin{figure}[htb]
  \centering
  \includegraphics[width=0.85\textwidth]{images/epnuml}
\caption{UML definition of the entity pool node and its descendant glyphs.}
  \label{fig:epnuml}
\end{figure}
 
The \sbgnclass{EntityPoolNode} (figure \ref{fig:epnuml}) is the common
ancestor of all these glyphs and defines attributes that are common to
all its descendants. It must belong to a compartment (c.f.\, section
\ref{sec:compartment})  and can contain a clone marker if it is
cloned. Note that not all EPNs can be cloned.

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{SBGNNode}
\end{itemize}

\subsubsection{Attributes}

\begin{attributes}
  \attitem{label}{string} The name that identifies the entity in the
  \PDm. EPNs with the same label should be from the same entity. the
  string cannot be empty and must start and end with a non-space
  character. Any Unicode character is acceptable.
  \attitem{cardinality}{int} The number of copies of the entity. Must
  be a positive non-zero integer.
  \attitem{nature}{cv} The nature of the entity pool node as defined
  by a controlled vocabulary. Zero, one or more values may be set, but
  each one must belong to a different controlled vocabulary.
\end{attributes}

\subsubsection{Associations}

\begin{attributes}
 \associtem{owning\_compartment}{Compartment}{0..1} The compartment
  that this EPN belongs too.
  \associtem{clone\_marker}{CloneMarker}{0..1} The clone marker
  decorator. See section \ref{sec:cloneMarker} for its use.
 \associtem{displayed\_attributes}{AttributeValue}{*} One or
 more decorators used to display attribute values.
\end{attributes}

\subsubsection{Rules and Constraints}

\begin{itemize}
\item If \attrib{cardinality} $>1$ then the descendant glyph must be displayed
  as a multimer.
\item If the EPN is drawn directly on a \glyph{Map} then
 \attrib{owning\_compartment} is assigned to an invisible default
 compartment.
 \attrib{nature} can only use the material type (section
 \ref{sec:mt}), conceptual type (section \ref{sec:ct}) or physical
 characteristics (section \ref{sec:pc}) controlled vocabularies.
\end{itemize}


\subsubsection{Notation}

\textbf{Possibly put this somwhere else.}

Although there is no direct graphical representation of this class
this class does affect the appearance of the
\sbgnclass{AttributeValue} and its associated glyph the \glyph{Unit of
  Information}. The \glyph{Unit of Information} can be used to present
the \attrib{cardinality} and \attrib{natures} attributes. These used
the following codes to indicate which attribute is being presented''

\begin{center}
  \begin{itemize}\setlength{\parskip}{0ex}
  \item[\texttt{pc}] container physical characteristic
  \item[\texttt{mt}] entity pool material type
  \item[\texttt{ct}] entity pool conceptual type
  \item[\texttt{N}]  multimer cardinality
  \end{itemize}
\end{center}


\subsubsection{Changes from Previous Version}

Not defined in the previous version.

\subsection{Empty Set}
\label{sec:sourceSink}

It is useful to have the ability to represent the creation of an entity or
a state from an unspecified source, that is, from something that one does
not need or wish to make precise.  For instance, in a model where the
production of a protein is represented, it may not be desirable to
represent all of the amino acids, sugars and other metabolites used, or the
energy involved in the protein's creation.  Similarly, we may not wish to
bother representing the details of the destruction or decomposition of some
biochemical species into a large number of more primitive entities,
preferring instead to simply say that the species ``disappears into a
sink''.  Yet another example is that one may need to represent an input
(respectively, output) into (resp. from) a compartment without explicitly
representing a transport process from a source (resp. to a target).

For these and other situations, SBGN defines a single glyph to handle
these situations representing the involvement of an external pool of entities.  The symbol
used in SBGN is borrowed from the mathematical symbol for ``empty set'',
but it is important to note that it does not actually represent a true
absence of everything or a physical void---it represents the absence of the
corresponding structures in the model, that is, the fact that the
external pool is conceptually outside the scope of the map.

A frequently asked question is, why bother having an explicit symbol at
all?  The reason is that one cannot simply use an arc that does not
terminate on a node, because the dangling end could be mistaken to be
pointing to another node in the map.  This is specially true if the
map is rescaled, causing the spacing of elements in the map to
change.  The availability and use of an explicit symbol for sources and
sinks is critical.

\begin{figure}[htb]
  \centering
  \includegraphics[width=0.75\textwidth]{images/emptysetuml}
  \caption{The UML definition of the \glyph{EmptySet} and its context
    in relation to other elements of the \PDl.}
  \label{fig:emptysetuml}
\end{figure}

The definition of the \glyph{Empty Set} is shown in figure
\ref{fig:emptysetuml}. The empty set is not an EPN as it does not
represent a single pool of entities and does not share any of the
other attributes of an EPN, nor does it belong to a particular
compartment.

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{SBGNNode}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

No additional associations.

\subsubsection{Rules and Constraints}

\begin{itemize}
\item  All instances of \glyph{Empty Set} can be regarded as identical
therefore not special decoration is used to indicate replication on
the map.
\end{itemize}

\subsubsection{Notation}

\paragraph{Glyph: \glyph{Empty Set}}

\begin{figure}[H]
  \centering
  \includegraphics[width = 0.1\textwidth]{images/sourceSink}
  \caption{The \glyph{empty set} glyph.}
  \label{fig:sourceSink}
\end{figure}

\begin{glyphDescription}
\glyphSboTerm SBO:0000291 ! empty set
\glyphAux None
\glyphContainer Represented by the mathematical symbol for ``empty
set'', that is, a circle crossed by a bar linking the upper-right and
lower-left corners of an invisible square drawn around the circle ($\emptyset$).
\fig{sourceSink} illustrates this.  The symbol should be linked to one
and only one edge in a map.
\glyphLabel None
\end{glyphDescription}

\subsubsection{Changes from Previous Version}

The \sbgnclass{EmptySet} and \glyph{Empty Set} glyph has replaced the \glyph{Source} and
\glyph{Sink} glyphs. This symbols used remains the same, but the
underlying concept has changed. The \glyph{Source} and \glyph{Sink}
glyphs where types of EPN.

\subsection{StatelessEPN}
\label{defn:StatelessEPN}

The \sbgnclass{StatelessEPN} (figure \ref{fig:statelessepnuml})
represents a pool where the entities do not change `state'. In
other-words the entities do not undergo any physical change that is
useful to record in a \PDm. Therefore these glyphs cannot be assigned
a state-variable.

\begin{figure}[htb]
  \centering
  \includegraphics[width=0.75\textwidth]{images/statelessepnuml}
\caption{UML definition of the stateless entity pool node and its descendant glyphs.}
  \label{fig:statelessepnuml}
\end{figure}

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{EntityPoolNode}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

No additional associations.

\subsubsection{Rules and Constraints}

\begin{itemize}
\item if a clone marker is used it must be of type \sbgnclass{SimpleCloneMarker}.
\end{itemize}

\subsubsection{Changes from Previous Version}

Not defined in the previous version.

\subsection{Simple chemical}
\label{sec:simpleChemical}

A simple chemical in SBGN is defined as the opposite of a
macromolecule (\sect{macromolecule}): it is a chemical compound that
is \emph{not} formed by the covalent linking of pseudo-identical
residues.  Examples of simple chemicals are an atom, a monoatomic ion,
a salt, a radical, a solid metal, a crystal, etc. The complex can be
represented by a monomeric glyph (\glyph{Simple chemical monomer}) and
a multimeric glyph (\glyph{Simple chemical multimer}).

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{StatelessEPN}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

No additional associations.

\subsubsection{Rules and Constraints}

No additional rules and constraints.

\subsubsection{Notation}

\paragraph{Glyph: \glyph{Simple chemical monomer}}

\begin{figure}[htb]
  \centering
  \includegraphics[scale = 0.3]{images/simpleChemical}
  \caption{The \PD glyph for \glyph{simple chemical}.}
  \label{fig:simpleChemical}
\end{figure}

\begin{glyphDescription}
\glyphSboTerm SBO:0000247 ! simple chemical
\glyphContainer A \glyph{simple chemical} is represented by a circular
container, as depicted in \fig{simpleChemical}. To avoid confusion
with the Unspecified Entity (\ref{sec:unspecifiedEntity}), this glyph
must remain a circle and cannot be deformed into an eclipse.
\glyphLabel The identification of the \glyph{simple chemical} is carried by an unbordered box containing a string of characters.  The characters may be distributed on several lines to improve readability, although this is not mandatory.  The label box has to be attached to the center of the circular container.  The label is permitted to spill outside the container.
\glyphAux 
\end{glyphDescription}

\paragraph{Glyph: \glyph{Simple chemical multimer}}

\begin{figure}[htb]
  \centering
  \includegraphics[scale = 0.3]{images/simpleChemicalMultimer}
  \caption{The \PD glyph for \glyph{multimer}.}
  \label{fig:multimer}
\end{figure}

\begin{glyphDescription}
\glyphSboTerm SBO:0000421 ! multimer of simple chemicals
\glyphContainer  A \glyph{simple chemical multimer} is represented by two identical containers shifted horizontally and vertically and stacked one on top of the other.  \fig{multimer} illustrates the glyph.
\glyphLabel A \glyph{multimer} has no identity on its own.  However, the first of the monomers carries an identifying label.  The label is placed in an unbordered box containing a string of characters.  The characters can be distributed on several lines to improve readability, although this is not mandatory.  The label box must be attached to the center of the top monomer's container.  The label may spill outside of the container.
\glyphAux 
\end{glyphDescription}

\subsubsection{Changes from Previous Version}

The glyphs used for the \sbgnclass{SimpleChemical} have been
changed. Previously the glyph was a circle.

\subsection{UnspecifiedEntity}
\label{sec:unspecifiedEntity}

The simplest type of EPN is the \sbgnclass{UnspecifiedEntity}: one whose
type is unknown or simply not relevant to the purposes of the map.
This arises, for example, when the existence of the entity has been
inferred indirectly, or when the entity is merely a construct
introduced for the needs of a map, without direct biological
relevance.  These are examples of situations where the
\sbgnclass{UnspecifiedEntity} is appropriate.  (Conversely, for
cases where the identity of the entities composing the pool \emph{is}
known, there exist other, more specific glyphs described elsewhere in
the specification.)

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{StatelessEPN}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

No additional associations.

\subsubsection{Rules and Constraints}

\begin{itemize}
\item The \sbgnclass{UnspecifiedEntity} cannot have cardinality $>
  1$. This means there is no multimer glyph.
\end{itemize}

\subsubsection{Notation}

\paragraph{Glyph: \glyph{Unspecified entity}}

\begin{glyphDescription}
\glyphSboTerm SBO:0000285 ! material entity of unspecified nature 
\glyphContainer An \glyph{unspecified entity} is represented by an
elliptic container, as shown in \ref{fig:unspecified}.  Note that this
must remain an ellipse to avoid confusion with the Simple Chemical
glyph, which is a circle (c.f.\, \ref{sec:simpleChemical}).
\glyphLabel An \glyph{unspecified entity} is identified by a label
placed in an unbordered box containing a string of characters.  The
characters can be distributed on several lines to improve readability,
although this is not mandatory.  The label box must be attached to the
center of the container.  The label may spill outside of the
container.
\end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[width=2.5in]{images/unspecified}
  \caption{The \PD glyph for \glyph{unspecified entity}.}
  \label{fig:unspecified}
\end{figure}

\subsubsection{Changes from Previous Version}

No changes from the previous version.

\subsection{Perturbing Agent}
\label{sec:perturbing agent}

Biochemical networks can be affected by external influences.  Those
influences can be the effect of well-defined physical perturbing
agents, such as a light pulse or a change in temperature; they can
also be more complex and not well-defined phenomena, for instance the
outcome of a biological process, an experimental setup, or a mutation.
For these situations, SBGN provides the \glyph{perturbing agent}
glyph. It is an EPN, and represents the amount to perturbing agent
applied to a process.

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{StatelessEPN}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

No additional attributes.

\subsubsection{Rules and Constraints}

\begin{itemize}
\item The \sbgnclass{PerturbingAgent} cannot have \attrib{cardinality} $>
  1$. This means there is no multimer glyph.
\end{itemize}

\subsubsection{Notation}

\paragraph{Glyph: \glyph{Perturbing agent}}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{images/perturbing_agent}
  \caption{The \PD glyph for \glyph{perturbing agent}.}
  \label{fig:perturbing agent}
\end{figure}

\begin{glyphDescription}
\glyphSboTerm SBO:0000405 ! perturbing agent
\glyphContainer A \glyph{perturbing agent} is represented by a modified hexagon
having two opposite concave faces, as illustrated in \fig{perturbing agent}.
\glyphLabel A \glyph{perturbing agent} is identified by a label placed in an
unbordered box containing a string of characters.  The characters can be
distributed on several lines to improve readability, although this is not
mandatory.  The label box must be attached to the center of the
\glyph{perturbing agent} container.  The label may spill outside of the container.
% \glyphAux A \glyph{perturbing agent} can optionally carry one or more \glyph{units of information} (\sect{unitInfo}).
% \glyphRules%
% \begin{inparaenum}
% \item A \glyph{perturbing agent} can optionally carry one or more \glyph{units of information} (\sect{unitInfo}).  A controlled vocaulary is available to describing the physical characteristic of the perturbing agent (see \sect{physical-characteristics-cv}).  
% \end{inparaenum}
% \glyphCloning Yes
\end{glyphDescription}

\subsubsection{Changes from Previous Version}

No changes from pervious version.

\subsection{StatefulEPN}
\label{defn:StatefulEPN}

Stateful entity pools can undergo physical changes, for example
chemical modifcation or conformational change, which we wish to record
in a \PDm. This information is captured via the
\sbgnclass{StateVariable}, as can be seen in figure
\ref{fig:statefulepnuml}). Replicated \sbgnclass{StatefulEPS}s are
indicated by the \glyph{Labelled Clone Marker} decoration. Note that
not all glyphs that are descendants of \sbgnclass{StatefulEPN} can be
cloned at all.

\begin{figure}[htb]
  \centering
  \includegraphics[width=0.75\textwidth]{images/statefulepnuml}
\caption{UML definition of the stateful entity pool node and its
  descendant glyphs and its association with state variables.}
  \label{fig:statefulepnuml}
\end{figure}

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{EntityPoolNode}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

\begin{itemize}
\associtem{states}{StateVariable}{*} The state variables
  associated with this EPN.
\end{itemize}

\subsubsection{Rules and Constraints}

\begin{itemize}
\item Two or more state variables with the same name are
  permitted.
\item State variables with no name set are permitted.
\item A \sbgnclass{LabelledCloneMaker} must be used to indicate
  cloning.
\item \sbgnclass{StatefulEPN}s that are identical and so decorated
  with a \sbgnclass{LabelledCloneMarker} must use the same 
  label to indicate that they are part of the same `clone'.
\end{itemize}

\subsubsection{Changes from Previous Version}

Not defined in the previous version.

\subsection{Macromolecule}
\label{sec:macromolecule}

Many biological processes involve \emph{macromolecules}: biochemical
substances that are built up from the covalent linking of
pseudo-identical units.  Examples of macromolecules include proteins,
nucleic acids (RNA, DNA), and polysaccharides (glycogen, cellulose,
starch, etc.).  Attempting to define a separate glyph for all of these
different molecules would lead to an explosion of symbols in SBGN, so
instead, \SBGNPDLone defines only one glyph for all macromolecules.
The same glyph is to be used for a protein, a nucleic acid, a complex
sugar, and so on.  The exact nature of a particular macromolecule in a
map is then clarified using its label and decorations, as will become
clear below.  (Future levels of SBGN may subclass the
\glyph{macromolecule} and introduce different glyphs to differentiate
between types of macromolecules). This has two associated glyphs. One
where 

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{StatefulEPN}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

No additional associations.

\subsubsection{Rules and Constraints}

No additional rules and constraints.

\subsubsection{Notation}

There are two glyphs associated with \sbgnclass{Macromolecule}. The
first \glyph{Macromolecule monomer} is used when \attrib{cardinality} $= 1$
and the second \glyph{Macromolecule multimer} is used when
\attrib{cardinality} $> 1$.

\paragraph{Glyph: \glyph{Macromolecule monomer}}

\begin{figure}[H]
  \centering
  \includegraphics[width = 3in]{images/macromolecule}
  \caption{The \PD glyph for \glyph{macromolecule}, shown plain and
    unadorned on the left, and with with an additional state variable and a
    unit of information in the right and the cloned form on the right.}
  \label{fig:macromolecule}
\end{figure}

\begin{glyphDescription}
\glyphSboTerm SBO:0000245 ! macromolecule 
\glyphContainer A macromolecule is represented by a rectangular container with rounded
corners, as illustrated in \fig{macromolecule}.
\glyphLabel A \glyph{macromolecule} is identified by a label placed in an unbordered box containing a string of characters.  The characters can be distributed on several lines to improve readability, although this is not mandatory.  The label box must be attached to the center of the container.  The label may spill outside of the container.
\end{glyphDescription}

\paragraph{Glyph: \glyph{Macromolecule multimer}}

\begin{figure}[H]
  \centering
  \includegraphics[width = 3.0in]{images/macromolMultimer}
  \caption{The \PD glyph for \glyph{macromolecule multimer}, shown plain and
    unadorned on the left, and with with an additional state variable and a
    unit of information on the right.}
  \label{fig:macromolMultimer}
\end{figure}

\begin{glyphDescription}
\glyphSboTerm SBO:0000420 ! multimer of macromolecules
\glyphContainer A \glyph{multimer} is represented by two identical containers shifted horizontally and vertically and stacked one on top of the other.  \fig{macromolMultimer} illustrates the glyph.
\glyphLabel As monomer
\end{glyphDescription}

\subsubsection{Changes from Previous Version}

No changes from the previous version.

\subsection{NucleicAcidFeature}
\label{sec:genetic}

The \sbgnclass{NucleicAcidFeature} represents a fragment of a macromolecule carrying genetic information.
A common use for this construct is to represent a gene or transcript.
The label of this EPN and its \attrib{nature} are often
important for making the purpose clear to the reader of a map.

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{StatefulEPN}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

No additional associations.

\subsubsection{Rules and Constraints}

No additional rules and constraints.

\subsubsection{Notation}

The \sbgnclass{NucleicAcidFeature} has two associated glyphs. The
first \glyph{Nucleic acid feature monomer} is used when
\attrib{cardinality} $=1$ and the second, \glyph{Nucleic acid feature
  multimer} is used when \attrib{cardinality} $>1$.

\paragraph{Glyph: \glyph{Nucleic acid feature monomer}}

This glyphs represents a monomeric macromolecule.

\begin{glyphDescription}
\glyphSboTerm SBO:0000354 !  informational molecule segment
\glyphContainer A \glyph{nucleic acid feature} is represented by a rectangular container whose bottom half has rounded corners, as shown in \fig{genetic}. This design reminds that we are fundamentally dealing with a unit of information, but this information is carried by a macromolecule.
\glyphLabel The identity of a particular \glyph{Nucleic acid feature} is established by a label placed in an unordered box containing a string of characters.  The characters may be distributed on several lines to improve readability, although this is not mandatory.  The label box must be attached to the center of the container.  The label may spill outside of the container.
%\glyphAux A \glyph{nucleic acid feature} can carry state variables (\sect{stateVariable}) that add information about its precise state.  The state of a \glyph{nucleic acid feature} is therefore defined as the vector of all its state variables. 

%A \glyph{nucleic acid feature} can also carry one or several \glyph{units of information} (\sect{unitInfo}).  These can characterize a \glyph{nucleic acid feature}'s domain, such as a binding site, or an exon.  Particular \glyph{units of information} carry the material type (\sect{material-types-cv}) and the conceptual type (\sect{conceptual-types-cv}) of the \glyph{nucleic acid feature}. 

%\glyphCloning Labeled Clone Marker

\end{glyphDescription}


\begin{figure}[H]
  \centering
  \includegraphics[width = 3in]{images/genetic}
  \caption{The \PD glyph for \glyph{nucleic acid feature monomer}, shown plain and
    unadorned on the left and with an additional state variable and a
    unit of information in the middle and the cloned form on the right.} 
  \label{fig:genetic}
\end{figure}

\paragraph{Glyph: \glyph{Nucleic acid feature multimer}}

This glyphs represents a multimeric macromolecule.

\begin{glyphDescription}

\glyphSboTerm SBO:0000419 ! multimer of informational molecule segments 

\glyphContainer A \glyph{Nucleic acid feature multimer} is represented by two identical containers shifted horizontally and vertically and stacked one on top of the other.  \fig{multimer} illustrates the glyph.

\glyphLabel As monomer glyph.

%\glyphAux A \glyph{nucleic acid feature} can carry state variables (\sect{stateVariable}) that add information about its precise state.  The state of a \glyph{nucleic acid feature} is therefore defined as the vector of all its state variables. 

%A \glyph{nucleic acid feature} can also carry one or several \glyph{units of information} (\sect{unitInfo}).  These can characterize a \glyph{nucleic acid feature}'s domain, such as a binding site, or an exon.  Particular \glyph{units of information} carry the material type (\sect{material-types-cv}) and the conceptual type (\sect{conceptual-types-cv}) of the \glyph{nucleic acid feature}. 

%A \glyph{nucleic acid feature} may also carry a \glyph{clone marker}
%(\sect{cloneMarker}).

\end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[width = 3in]{images/geneticMultimer}
  \caption{The \PD glyph for \glyph{nucleic acid feature multimer}, shown plain and
    unadorned on the left and with an additional state variable and a
    unit of information in the middle and the cloned form on the right.} 
  \label{fig:genetic-multimer}
\end{figure}

\subsubsection{Changes from Previous Version}

No changes from the previous version.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%                   Complex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Complex}\label{sec:complex}
\label{defn:complex}

A \sbgnclass{Complex} represents a biochemical entity composed of
other biochemical entities, whether macromolecules, simple chemicals,
multimers, or other complexes (figure
\ref{fig:complexsubunituml}). The \sbgnclass{Complex} can described
its composition by the set of \sbgnclass{Subunit}s it contains (see
figure \ref{sec:subunits}). This description is entirely optional and
is their to assist the user with a visual shorthand about the
composition of the complex.

\begin{figure}[htb]
  \centering
  \includegraphics[width = 0.65\textwidth]{images/complexsubunituml}
  \caption{The UML definition of the \sbgnclass{Complex} and its
    associated \sbgnclass{subunit}s. In particular this describes organisation
   of the state variables that belong to both the subunit, but also
   the complex.}
  \label{fig:complexsubunituml}
\end{figure}

\subsubsection{Generalisations}

\begin{itemize}
\item \classref{EntityPoolNode} 
\end{itemize}

\subsubsection{Attributes}

No additional attributes 

\subsubsection{Associations}

\begin{attributes}
  \associtem{subunits}{\sbgnclass{Subunit}}{*} The subunits that describe
  the composition of this complex.
 \end{attributes}


\subsubsection{Special Rules and Constraints}

\begin{itemize}
\item Once a set of subunits are defined then they are always defined.
\item The set of subunits in the Complex does not identify it. One or
  more Complexes that contain the same set of subunits, but have
  different labels are \textbf{not} identical.
\end{itemize}

% \begin{glyphDescription}
% \glyphName \sbgnclass{Complex}
% \glyphSboTerm Not defined
% \begin{glyphIdentity}
%   \attitem{subunits}{\sbgnclass{Subunit}} The subunits that describe
%   the composition of this complex.
%  \end{glyphIdentity}
% \glyphRules
% \begin{itemize}
%   \item Once a set of subunits are defined then they are always
%     defined.
% \end{itemize}
% \end{glyphDescription}

\subsubsection{Notation}

The Complex is represented by two glyphs, the \glyph{Complex Monomer}
which represents a \sbgnclass{Complex} where the \attrib{cardinality}
is one and the \glyph{Complex Multimer} where the cardinality is
greater than that.

\paragraph{\glyph{Complex Monomer}}

\begin{figure}[H]
  \centering
  \includegraphics[width=3.5in]{images/complexGlyph}
  \caption{The \glyph{complex} glyph.}
  \label{fig:complex}
\end{figure}

\begin{glyphDescription}
\glyphSboTerm SBO:0000253 ! non-covalent complex
\glyphAux A \glyph{complex} can carry state variables (see \sect{stateVariable}).  The state of a complex is defined by the set of the all its state variable and all the state variables of all its components.  A \glyph{complex} can also carry one or several \glyph{units of information} (see \sect{unitInfo}). A \glyph{complex} may carry a \glyph{clone marker} (see \sect{cloneMarker}).
\glyphCloning Labeled Clone Marker
\glyphContainer A \glyph{complex} possesses its own container box surrounding the juxtaposed container boxes of its components.  This container box is a rectangle with cut-corners (an octagonal box with sides of two different lengths).  The size of the cut-corners are adjusted so that there is no overlap between the container and the components.  The container boxes of the components must not overlap.
\glyphLabel The identification of a \glyph{named complex} is carried
by an unbordered box containing a string of characters.  The
characters may be distributed on several lines to improve readability,
although this is not mandatory.  Ideally the label box should be
attached to the midway between the border of the complex's container
box and the border of the components' container boxes. However, if the
Complex contains Subunit glyphs then the label may be positions to
optimise the clarity and avoid overlapping.
\end{glyphDescription}


\paragraph{\glyph{Complex Multimer}}

\begin{figure}[H]
  \centering
  \includegraphics[width = 3.5in]{images/complexMultimerGlyph}
  \caption{The \glyph{Complex Multimer} glyph.}
  \label{fig:complexMultimer}
\end{figure}

 \begin{glyphDescription}
\glyphSboTerm SBO:0000418 ! multimer of complexes
\glyphAux As monomer.
\glyphCloning Labeled Clone Marker
\glyphContainer A \glyph{Complex Multimer} is represented by two
identical \glyph{Complex} containers shifted horizontally and
vertically and stacked one on top of the other.  \fig{complexMultimer}
illustrates the glyph.
\glyphLabel As monomer
\end{glyphDescription}

\paragraph{Examples of complex EPNs}
\label{sec:CplxEPNs}

In this section, we provide examples of Entity Pool Node representations drawn using the \SBGNPDLone glyphs described above. 

\fig{example-camkii} represents calcium/calmodulin kinase II, with phosphorylation on the sites threonine 286 and 306, as well as catalytic and autoinhibitory domains.  Note the use of \emph{units of information} and \emph{state variables}.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{examples/macromolecule-CaMKII}
  \caption{An example representation of calcium/calmodulin kinase II.}
  \label{fig:example-camkii}
\end{figure}

\fig{example-glur} represents the glutamate receptor in the open state, with both phosphorylation and glycosylation.  The entity carries two functional domains, the ligand-binding domain and the ion pore, and its chemical nature is precided.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{examples/macromolecule-GluR}
  \caption{An example of a glutamate receptor in the open state.}
  \label{fig:example-glur}
\end{figure}


\subsubsection{Layout Rules and Guidelines}

\begin{itemize}
\item The subunits inside the complex must not overlap.
\item The subunits should sit above the clone marker so that they are
  not obscured by it.
\item The label should not be obscured by subunits or obscure them.
\end{itemize}


\subsubsection{Changes from Previous Version}

\begin{itemize}
\item Clarified that complex must have a label and the label
  identifies the complex irrespective of its subunit composition.
\item The label positioning does not need to be at the centre of the
  Complex glyph.
\end{itemize}

\subsection{Subunit}
\label{defn:subunit}\label{sec:subunits}

A complex can optionally be decorated with subunit symbols
(\sbgnclass{Subunit} see figure \ref{fig:complexsubunituml}) to
describe the composition of the complex. The symbols available are
equivalent to those used by the EPN glyphs including the
\glyph{complex}. Therefore it is possible to describe complexes within
complexes. Subunits may contain labels. 

\begin{center}
\tablecaption{Mapping between the subunit types and the glyphs used to
  represent it. These are essentially the EPN glyphs described in this document.}
\label{tab:subunit types}
\begin{footnotesize}
\tablefirsthead{\hline
  Subunit type & Monomer Glyph & Multimer Glyph\\\hline}
\tablehead{\hline
\multicolumn{3}{|l|}{\small\sl continued from previous page}\\
\hline\hline
  Subunit type & Monomer Glyph & Multimer Glyph\\\hline\hline}
\tabletail{\hline
\multicolumn{3}{|r|}{\small\sl continued on next page}\\
\hline}
\tablelasttail{\hline}
\begin{supertabular}{|l|l|l|}\hline
SimpleChemical &  \glyph{Simple Chemical Monomer} & \glyph{Simple
  Chemical Multimer}\\\hline
UnspecifiedEntity & \glyph{Unspecificed Entity} & None\\\hline
PerturbingAgent & \glyph{Perturbing Agent} & None\\\hline
Macromolecule & \glyph{Macromolecule Monomer} &
\glyph{Macromolecule Multimer}\\\hline
Nucleic\-Acid\-Feature & \glyph{Nucleic Acid Feature Monomer} & \glyph{Nucleic Acid Feature Multimer}\\\hline
Complex & \glyph{Complex Monomer} & \glyph{Complex Multimer}\\\hline
\end{supertabular}
\end{footnotesize}
\end{center}

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{EntityPoolNode} 
\end{itemize}

\subsubsection{Attributes}

\begin{attributes}
  \attitem{cardinality}{int} The number of copies of the subunit.
  \attitem{name}{string} The name of the subunit.
  \attitem{subunit\_type}{enum} The type of the subunit. It can have
  one of the following values that correspond to the equivalent EPN
  class: \sbgnclass{SimpleChemical}, \sbgnclass{UnspecifiedEntity},
  \sbgnclass{PerturbingAgent}, \sbgnclass{Macromolecule},
  \sbgnclass{NucleicAcidFeature}, \sbgnclass{Complex}.
\end{attributes}

\subsubsection{Associations}

\begin{attributes}
  \associtem{owning\_complex}{Complex}{1} The complex that owns the subunit.
  \associtem{states}{SubunitStateVariable}{*} The state variables assigned
  to this subunit.
  \associtem{children}{Subunit}{*} Subunits that are contained by this subunit.
\end{attributes}

\subsubsection{Rules and Constraints}

\begin{itemize}
\item Two or more state variables with the same name are
  permitted.
\item State variables with no name set are permitted.
\item Subunits can also contain subunits. There is no limit on such nesting. The namespace rules
  below apply.
\item Each state variable actually belongs to the Complex.
\item The subunit defines a namespace for its state variables, e.g.\,
  subunit ``A'' assigned a state variable ``P@Ser202''  and a subunit
  ``B'' assigned the same state variable can be distinguised as
  A:P@Ser202 and B:P@Ser202.
\item If the subunit is of type Complex then \attrib{children} can contain one or
  more \sbgnclass{Subunit} instances.
\item If the subunit has a cardinality $>1$ then this should be
  displayed by the \classref{AttributeValue}.
\item If \attrib{natures} contains one or more instances then these
  must be displayed via a \sbgnclass{AttributeValue}.
\end{itemize}

\subsubsection{Notation}

The example in figure \fig{complexSubunits} illustrates the use of
subunits in a complex shows an equivalent compex without
subunits. This is an import point. For every \glyph{Complex} drawn
with subunits it will always be possible to drawn an equivalent
version that does not use contains subunits.

\begin{figure}[H]
  \centering
  \includegraphics[width = 3.0in]{images/complex}
  \caption{Both these complex glyphs are equivalent. The one on the
    left is described using subunit decorators, the one on the right
    describes the same thing without them.}
  \label{fig:complexSubunits}
\end{figure}

\subsubsection{Changes from Previous Version}

%%%%%%%%%%%%
% Put the following in the semantics section

% \subsubsection{Attributes}


% The complex has the following attributes (those in \emph{italic} identify the complex):

% \begin{description}
% \item[\emph{name}]
% \item[\emph{cardinality}] The number of subunits of the complex. If
%   cardinality $> 1$ then the \glyph{Complex Multimer} must be
%   drawn. Otherwise a \glyph{Complex} is drawn. The cardinality is an
%   integer $>0$.
% \item[\emph{compartment}] The complex must belong to one compartment.
% \item[state variables] The complex can have zero, one or more state
%   variables. 
% \item[clone ID]
% \end{description}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%                   Process nodes
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{ProcessNode}\label{sec:PNs}
\label{defn:ProcessNode}

The \sbgnclass{Process} (figure \ref{fig:processumlview}) represents a process that transforms one or
more entity pools into one or more entity pools, that are identical or
different. A process may be used to represent or summarise more than
one known process.  \SBGNPDLone defines a generic \glyph{process}
(\sect{process}), as well as five more specific ones: the
\glyph{omitted process} (\sect{omitted}), the \glyph{uncertain
  process} (\sect{uncertain}), the \glyph{association}
(\sect{association}), the \glyph{dissociation} (\sect{dissociation}),
and the \glyph{phenotype} (\sect{phenotype}).

\begin{figure}[htb]
  \centering
  \includegraphics[width = 0.65\textwidth]{images/processumlview}
  \caption{The UML definition of the \sbgnclass{Process} and its
    associated subclasses. Note that the \sbgnclass{Process} extends
    \sbgnclass{SBGNNode} so all its descendants can potentially be
    nodes in a directed graph.}
  \label{fig:processumlview}
\end{figure}


\subsubsection{Generalisation}

\begin{itemize}
\item \classref{SBGNNode}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

No additional associations.

\subsubsection{Rules and Constraints}

No additional rules and constraints.

\subsubsection{Changes from Previous Version}
\begin{itemize}
\item This was not explicitly defined in the previous version, but
  this version did define a glyph called \glyph{Process}. To avoid
  ambiguity this glyph has now been renamed \glyph{Stoichiometric
    Process} (see section \ref{sec:stoichiometricprocess}).
\item Previous specifications stated that processed could be
  duplicated when all associated EPNs were cloned. This behaviour has
  been changed the current status where all processes are unique in a \PDm.
\end{itemize}

\subsection{NonStoichiometricProcess}
\label{defn:NonStoichiometricProcess}

The \sbgnclass{NonStoichiometricProcess} (figure
\ref{fig:nonstoichprocessuml}) is a type of process. It does not
necessarily result in a measurable change of entity pools, nor does it
necessarily have a defined start and end point. In many cases the
process is not well defined. This may because it is not well
understood or because the detail is not important or is being
summarised.

\begin{figure}[htb]
  \centering
  \includegraphics[width = 0.45\textwidth]{images/nonstoichprocessuml}
  \caption{The UML definition of the \sbgnclass{NonStoichiometricProcess} and its
    associated subclasses.}
  \label{fig:nonstoichprocessuml}
\end{figure}

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{ProcessNode}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

No additional associations.

\subsubsection{Rules and Constraints}

No additional rules and constraints.

\subsubsection{Changes from Previous Version}

Not defined in the previous version.

\subsection{Phenotype}

A biochemical network can generate phenotypes or affect biological
processes.  Such processes can take place at different levels and are
independent of the biochemical network itself.  To represent these
processes in a map, SBGN defines the \sbgnclass{Phenotype} (figure \ref{fig:nonstoichprocessuml}).

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{NonStoichiometricProcess}
\end{itemize}

\subsubsection{Attributes}

No additional attributes.

\subsubsection{Associations}

No additional associations.

\subsubsection{Rules and Constraints}

\begin{itemize}
\item The \sbgnclass{Phenotype} can only be modulated.
\item The \sbgnclass{Phenotype} must be connected to at least one
  modulating arc.
\end{itemize}

\subsubsection{Notation}

\paragraph{Glyph: \glyph{Phenotype}}
\label{sec:phenotype}

\begin{glyphDescription}

\glyphSboTerm SBO:0000358 ! phenotype

\glyphContainer A \glyph{phenotype} is represented by an elongated
hexagon, as illustrated in \fig{phenotype}.

\glyphLabel A \glyph{phenotype} is identified by a label placed in an
unbordered box containing a string of characters.  The characters can be
distributed on several lines to improve readability, although this is not
mandatory.  The label box must be attached to the center of the
\glyph{phenotype} container.  The label may spill outside of the container.
\end{glyphDescription}
 
\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{images/phenotype}
  \caption{The \PD glyph for \glyph{phenotype}.}
  \label{fig:phenotype}
\end{figure}


\subsubsection{Changes from Previous Version}

Clarified that the \sbgnclass{Phenotype} cannot be cloned as it is now
a subclass of \sbgnclass{Process}, which is always unique.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%                   Submap
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{SubmapNode}
\label{sec:submap}\label{defn:SubmapNode}

The \sbgnclass{SubmapNode} ( figure \ref{fig:submapnodeuml} ) is a
placeholder for another process and is used when one wishes to hide
the detail of this process from the \PDm, but make it available to the
reader as a separate related map. The \sbgnclass{Submap} is not
equivalent to an \sbgnclass{OmittedProcess} (section
\ref{sec:omitted}). The \sbgnclass{Submap} allows the detail of
section of the \PDm to be exported to another \PDm and replaced by the
\sbgnclass{SubmapNode}, which acts as a place-holder.  This is
described in section \ref{sec:map} and the semantics of submap linking
is defined in section \ref{sec:submaplinkingsemantics}.

\begin{figure}[htb]
  \centering
  \includegraphics[width = 0.65\textwidth]{images/submapnodeuml}
  \caption{The UML definition of the \sbgnclass{SubmapNode} and its
   relationship to its submap, tags etc.}
  \label{fig:submapnodeuml}
\end{figure}

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{NonStoichiometricProcess}
\end{itemize}

\subsubsection{Attributes}

\begin{attributes}
  \attitem{name}{string} The name of the submap that is being
  summarised. Note that this name ideally will indicate the function
  or the processes that are being summarised.
\end{attributes}

\subsubsection{Associations}

\begin{attributes}
\associtem{terminals}{SubmapTerminal}{1..*} The terminals provide a
reference between the EPNs in the Main Map and those in the submap,
which are identified by a \sbgnclass{Tag}.
\end{attributes}

\subsubsection{Rules and Constraints}


\subsubsection{Notation}

\paragraph{Glyph: \glyph{Submap Node}}

\begin{glyphDescription}

\glyphSboTerm SBO:0000395 ! encapsulating process

\glyphContainer The \glyph{submap} is represented as a square box to remind the viewer that it is fundamentally a process.

\glyphLabel The identification of the \glyph{submap} is carried by an unbordered box containing a string of characters.  The characters may be distributed on several lines to improve readability, although this is not mandatory.  The label box has to be attached to the center of the container box.

\glyphAux A \glyph{submap} carries labeled terminals.  When the \glyph{submap} is represented folded, those terminals are linked to external \glyph{EPNs} (\sect{EPNs}).  In the unfolded view, exposing the internal structure of the \glyph{submap}, a set of \glyph{tags} point to the corresponding internal \glyph{EPNs} \sect{EPNs}.

\end{glyphDescription}


\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.22]{images/submap}
  \caption{The \PD glyph for \glyph{submap}. (Upper part) folded submap. (Lower part) content of the submap.}
  \label{fig:submap}
\end{figure}

\subsubsection{Changes from Previous Version}

This glyph was called \glyph{Submap} in previous version of the \PD
specification. This is confusing when talking about the Submap itself
so this glyph is now referred to as the SubmapNode to distinguish it.

\subsection{LogicalOperator}
\label{sec:logic}

\begin{figure}[htb]
  \centering
  \includegraphics[width = 0.5\textwidth]{images/logicaloperatoruml}
  \caption{The UML definition of the \sbgnclass{LogicalOperator}.}
  \label{fig:logicaloperatoruml}
\end{figure}

 The \sbgnclass{LogicalOperator} (figure \ref{fig:logicaloperatoruml} performs a Boolean operation on one or
more inputs to give a binary output. The input must be a Boolean
value, and are obtained from the \classref{LogicArc} connected to the
\sbgnclass{LogicOperator}. The output a two-value quantity,  0 for False and positive
non-zero for True. This is required because the output of the
\sbgnclass{LogicOperator} must be connected to either a
\sbgnclass{LogicArc} or a \classref{ModulationArc} both of which
require their out node to provide a quality. The behaviour of the
logical operator for each type of \attrib{operator\_type} is shown in
the following table:

\begin{tabular}[t]{c p{12cm}}
\toprule
AND & All inputs must be True for output to be True, otherwise output
is false.\\
OR & At least one input must be True for output to be True. If all
inputs are False then output is False.\\
NOT & Only one input is permitted and the output is the inversion of
the input. Therefore True gives False and False gives True.\\
\bottomrule
\end{tabular}

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{NonStoichiometricProcess}
\end{itemize}

\subsubsection{Attributes}

\begin{attributes}
  \attitem{operator\_type}{enum} The operator type must be one of the
  following enumerations: AND, OR, NOT.
\end{attributes}

\subsubsection{Associations}

No additional associations.

\subsubsection{Rules and Constraints}

\begin{itemize}
\item \attrib{in\_arc} can only contain one or more instances of
  \sbgnclass{LogicArc}.
\item \attrib{out\_arc} can only contain one or more instances of
  \sbgnclass{LogicArc} or \sbgnclass{ModulatingArc}.
\item if \attrib{operator\_type} is AND or OR, then \attrib{in\_arc} must
  contain two or more arcs.
\item if \attrib{operator\_type} is NOT then \attrib{in\_arc} must
  contain only one arc.
\item \attrib{out\_arc} can contain only one arc.
\end{itemize}

\subsubsection{Notation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     And
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\color{blue}
\paragraph{Glyph: \glyph{And}}\label{sec:and}

\begin{glyphDescription}
 \glyphSboTerm SBO:0000173 ! and.
 \glyphOrigin More than one \glyph{EPN} (section~\ref{sec:EPNs}) or \glyph{logical operator} (section~\ref{sec:logic}).
 \glyphTarget  One modulation (section~\ref{sec:modulation}), stimulation (section~\ref{sec:stimulation}), catalysis (section~\ref{sec:catalysis}), inhibition (section~\ref{sec:inhibition}) or necessary stimulation (section~\ref{sec:necessary_stim}) arc.
 \glyphNode \glyph{And} is represented by a circle carrying the word ``AND''.
\end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{images/and}
  \caption{The \PD glyph for \glyph{and}. Only two inputs are represented, but more would be allowed.}
  \label{fig:and}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Or
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Glyph: \glyph{Or}}\label{sec:or}

\begin{glyphDescription}
 \glyphSboTerm SBO:0000174 ! or.
 \glyphOrigin More than one \glyph{EPN} (section~\ref{sec:EPNs}) or \glyph{logical operator} (section~\ref{sec:logic}).
 \glyphTarget  One modulation (section~\ref{sec:modulation}), stimulation (section~\ref{sec:stimulation}), catalysis (section~\ref{sec:catalysis}), inhibition (section~\ref{sec:inhibition}) or necessary stimulation (section~\ref{sec:necessary_stim}) arc.
 \glyphNode \glyph{Or} is represented by a circle carrying the word ``OR''.
 \end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{images/or}
  \caption{The \PD glyph for \glyph{or}. Only two inputs are represented, but more would be allowed.}
  \label{fig:or}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Not
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Glyph: \glyph{Not}}\label{sec:not}

\begin{glyphDescription}
 \glyphSboTerm SBO:0000238 ! not.
 \glyphOrigin One \glyph{EPN} (section~\ref{sec:EPNs}) or \glyph{logical operator} (section~\ref{sec:logic}).
 \glyphTarget  One modulation (section~\ref{sec:modulation}), stimulation (section~\ref{sec:stimulation}), catalysis (section~\ref{sec:catalysis}), inhibition (section~\ref{sec:inhibition}) or necessary stimulation (section~\ref{sec:necessary_stim}) arc.
 \glyphNode \glyph{Not} is represented by a circle carrying the word ``NOT''.
 \end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{images/not}
  \caption{The \PD glyph for \glyph{not}.}
  \label{fig:not}
\end{figure}

\subsubsection{Changes from Previous Version}

Although the \sbgnclass{LogicOperator} was not explicitly defined in
the previous version the semantics and glyphs are unchanged.


\subsection{StoichiometricProcess}
\label{defn:StoichiometricProcess}\label{sec:stoichiometricprocess}

\begin{figure}[htb]
  \centering
  \includegraphics[width = 0.65\textwidth]{images/stoichprocessuml}
  \caption{The UML definition of the
    \sbgnclass{StiochiometricProcess}. The class interacts with
    subclasses of \sbgnclass{FluxArc} and \sbgnclass{ModulationArc}.}
  \label{fig:stoichprocessuml}
\end{figure}
 
A process that produces a measurable change in the quantities of entity pools
consumed and produced. The \sbgnclass{StoichiometricProcess} can be
one of different types, which indicate the amount that is known about
the process or in some cases the nature of the process, for example
association and dissociation. The permitted values for
\attrib{process\_type} are described in the following table:

\begin{tabular}[c]{l p{12cm}}
\\\toprule
generic & A generic stoichiometric process that transforms a set of entity pools into another set of entity pools.\\
omitted & Omitted processes are processes that are known to exist, but are omitted from the map for the sake of clarity or parsimony. A single \glyph{omitted process} can represent any number of actual processes. The \glyph{omitted process} is different from a \glyph{submap}. While a \glyph{submap} references to an explicit content, that is hidden in the main map, the \glyph{omitted process} does not ``hide'' anything within the context of the map, and cannot be ``unfolded''.\\
uncertain & Uncertain processes are processes that may not exist. A single \glyph{uncertain process} can represent any number of actual processes.\\
association & The association between one or more \glyph{EPNs} represents the non-covalent binding of the biological objects represented by those \glyph{EPNs} into a larger complex.\\
dissociation & The dissociation of an \glyph{EPN} into one or more \glyph{EPNs} represents the rupture of a non-covalent binding between the biological entities represented by those \glyph{EPNs}.\\
\bottomrule\\
\end{tabular}\\


The \sbgnclass{StoichiometricProcess} describes a process that transforms a given set of biochemical entities---macromolecules, simple chemicals or unspecified entities---into another set of biochemical entities.  Such a transformation might imply modification of covalent bonds (conversion), modification of the relative position of constituents (conformational process) or movement from one compartment to another (translocation).

A cardinality label may be associated with \glyph{consumption} (\sect{consumption}) or \glyph{production} (\sect{production}) arcs to indicate the stoichiometry of the process.  This label becomes a requirement when the exact composition of the number of copies of the inputs or outputs to a reaction are ambiguous in the map.

A process is regarded as reversible if both `sides' of the process are connected to \glyph{production} arcs (see section \ref{sec: semantics reversible procs}).

\subsubsection{Generalisation}

\begin{itemize}
\item \classref{ProcessNode}
\end{itemize}

\subsubsection{Attributes}

\begin{attributes}
  \attitem{process\_type}{enum} This must be one of the following
  enumerations: generic, omitted, uncertain, association, dissociation.
\end{attributes}

\subsubsection{Associations}

No additional associations.

\subsubsection{Rules and Constraints}

\begin{itemize}
\item The \attrib{in\_arc} must contain one or more
  \sbgnclass{FluxArc} of the same type, \ie all \sbgnclass{FluxArc}s be of class
  \sbgnclass{ConsumptionArc} or all of class
  \sbgnclass{ProductionArc}.
\item In addition the \attrib{in\_arc} may contain zero, one or more
  instances of \sbgnclass{ModulationArc}.
\item The \attrib{out\_arc} must contain one or more
 instances of \sbgnclass{ProductionArc}.
\item If \attrib{process\_type} is association then the
  \attrib{in\_arc} must only contain arcs of type
  \sbgnclass{ConsumptionArc} and \attrib{out\_arc} can only contain
  one \sbgnclass{ProductionArc}.
\item If \attrib{process\_type} is dissociation then the
  \attrib{in\_arc} can contain only one \sbgnclass{ConsumptionArc}
  instance.
\item If a \sbgnclass{StoichiometricProcess} only contains in and out
  arcs of class \sbgnclass{ProductionArc} then it is regarded as
  reversible.
\end{itemize}

\subsubsection{Notation}

\paragraph{Glyph: \glyph{Process}}
\label{sec:process}

\begin{glyphDescription}

\glyphSboTerm SBO:0000375 ! process

\glyphOrigin One or several \glyph{consumption} arcs (\sect{consumption}) or one or several \glyph{production} arcs (\sect{production}).

\glyphTarget One or several \glyph{production} arcs (\sect{production}).

\glyphNode A process is represented by a square box linked to two connectors, small arcs attached to the centers of opposite sides. The consumption (\sect{consumption}) and production (\sect{production}) arcs are linked to the extremities of those connectors. The modulatory arcs (\sect{arcs}) point to the other two sides of the box. A \glyph{process} connected to \glyph{production} arcs on opposite sides is a reversible process. 

\end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.4]{images/process}
  \caption{The \PD glyph for \glyph{process}.}
  \label{fig:process}
\end{figure}


The example in \fig{trans-phos} illustrates the use of a \glyph{process} node to represent the phosphorylation of a protein in a \PD.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{examples/process-phosphorylation}
  \caption{Phosphorylation of the protein MAP kinase.}
  \label{fig:trans-phos}
\end{figure}

The example in \fig{trans-react} illustrates the use of a \glyph{process} node to represent a reaction between two reactants that generates three products. 

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{examples/process-reaction}
  \caption{Reaction between ATP and fructose-6-phosphate to produce fructose-1,6-biphosphate, ADP and a proton.}
  \label{fig:trans-react}
\end{figure}

The example in \fig{trans-trans} illustrates the use of a \glyph{process} node to represent a translocation. The large round-cornered rectangle represents a compartment border (see \sect{compartment}).

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{examples/process-translocation}
  \caption{Translocation of calcium ion out of the endoplasmic reticulum. Note that the \glyph{process} does not have to be located on the boundary of the \glyph{compartment}. A \glyph{process} is not attached to any \glyph{compartment}.}
  \label{fig:trans-trans}
\end{figure}

The example in \fig{trans-reverse} illustrates the use of a \glyph{process} node to represent the reversible opening and closing of an ionic channel in a \PD.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{examples/process-reversible}
  \caption{Reversible opening and closing of an ionic channel.}
  \label{fig:trans-reverse}
\end{figure}

When such a reversible process is asymmetrically modulated, it must be represented by two different processes in a \PD.  \fig{trans-mod} illustrates the use of two \glyph{process} nodes to represent the reversible activation of a G-protein coupled receptor.  In the absence of any effector, an equilibrium exists between the inactive and active forms.  The agonist stabilises the active form, while the inverse agonist stabilises the inactive form.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{examples/process-modulated}
  \caption{The reversible activation of a G-protein coupled receptor.}
  \label{fig:trans-mod}
\end{figure}

The example in \fig{trans-dim} presents the conversion of two galactoses into a lactose.  Galactoses are represented by only one \glyph{simple chemical}, the cardinality being carried by the \glyph{consumption} arc.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{examples/process-dimerisation}
  \caption{Conversion of two galactoses into a lactose.}
  \label{fig:trans-dim}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Omitted Process
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Glyph: \glyph{Omitted process}}\label{sec:omitted}


\begin{glyphDescription}
 \glyphSboTerm SBO:0000397 - omitted process.
 \glyphOrigin One or several \glyph{consumption} arcs (\sect{consumption}) or one or several \glyph{production} arcs (\sect{production}).
 \glyphTarget One or several \glyph{production} arcs (\sect{production}).

 \glyphNode An \glyph{omitted process} is represented by a \glyph{process} in which the square box contains a two parallel slanted lines oriented northwest-to-southeast and separated by an empty space.
 \end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{images/omitted}
  \caption{The \PD glyph for \glyph{omitted process}.}
  \label{fig:omitted}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Uncertain Process
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Glyph: \glyph{Uncertain process}}\label{sec:uncertain}

\begin{glyphDescription}
 \glyphSboTerm SBO:0000396 ! uncertain process.
 \glyphOrigin One or several \glyph{consumption} arcs (\sect{consumption}) or one or several \glyph{production} arcs (\sect{production}).
 \glyphTarget One or several \glyph{production} arcs (\sect{production}).
 \glyphNode An \glyph{uncertain process} is represented by a \glyph{process} which square box contains a question mark.
 \end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{images/uncertain}
  \caption{The \PD glyph for an \glyph{uncertain process}.}
  \label{fig:uncertain}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Association
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Glyph: \glyph{Association}}\label{sec:association}


\begin{glyphDescription}
 \glyphSboTerm SBO:0000177 ! non-covalent binding.
 \glyphOrigin One or more \glyph{consumption} arcs (\sect{consumption}).
 \glyphTarget  One \glyph{production} arc (\sect{production}).
 \glyphNode An \glyph{association} between several entities is represented by a filled disc linked to two connectors, small arcs attached on point separated by 180 degrees. The consumption (\sect{consumption}) and production (\sect{production}) arcs are linked to the extremities of those connectors. 
 \end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{images/association}
  \caption{The \PD glyph for \glyph{association}.}
  \label{fig:association}
\end{figure}

The example in \fig{assoc-cyclin} illustrates the association of cyclin and CDC2 kinase into the Maturation Promoting Factor.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{examples/association-MPF}
  \caption{Association of cyclin and CDC2 kinase into the Maturation Promoting Factor.}
  \label{fig:assoc-cyclin}
\end{figure}

\fig{assoc-unamed} gives an example illustrating the association of a pentameric macromolecule (a nicotinic acetylcholine receptor) with a simple chemical (the local anesthetic chlorpromazin) in an unnamed complex.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{examples/association-unamed}
  \caption{The association of a pentameric macromolecule with a simple chemical in an unnamed complex.}
  \label{fig:assoc-unamed}
\end{figure}

An association does not necessarily result in the formation of a \glyph{complex}; it can also produce a \glyph{multimer}, or a \glyph{macromolecule} (although the latter case is semantically borderline).  \ref{fig:assoc-multi} gives an example of this, using the formation of hemoglobin.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{examples/association-multimerisation}
  \caption{Formation of hemoglobin.}
  \label{fig:assoc-multi}
\end{figure}

\paragraph{Glyph: \glyph{Dissociation}}\label{sec:dissociation}

\begin{glyphDescription}
 \glyphSboTerm SBO:0000180 ! dissociation.
 \glyphOrigin One \glyph{consumption} arc (\sect{consumption}).
 \glyphTarget  One or more \glyph{production} arc (\sect{production}).
 \glyphNode A \glyph{dissociation} between several entities is represented by two concentric circles. A simple empty disc could be, in some cases, confused with the \glyph{catalysis} (section \sect{catalysis}). Moreover, the existence of two circles reminds the dissociation, by contrast with the filled disc of the \glyph{association} (\sect{association}).
 \end{glyphDescription}


\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{images/dissociation}
  \caption{The \PD glyph for \glyph{dissociation}.}
  \label{fig:dissociation}
\end{figure}

The example in \fig{dissoc-ribo} illustrates the dissociation of the small and large ribosomal subunits from a messenger RNA.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{examples/dissociation-ribosome}
  \caption{Dissociation of the small and large ribosomal subunits from a messenger RNA.}
  \label{fig:dissoc-ribo}
\end{figure}

\subsubsection{Changes from Previous Version}

Although the \sbgnclass{NonStoichiometricProcess} was not explicitly defined in
the previous version the semantics and glyphs are unchanged.
 
\subsection{Compartment}

\begin{figure}[htb]
  \centering
  \includegraphics[width = 0.5\textwidth]{images/compartmentuml}
  \caption{The UML definition of the \sbgnclass{Compartment} showing
    how it containment of \sbgnclass{EntityPoolNode}.}
  \label{fig:compartmentuml}
\end{figure}

The \sbgnclass{Compartment} is a logical or physical structure that
contains entity pool nodes. An \classref{EntityPoolNode} can only
belong to one compartment. Therefore, the ``same'' biochemical species
located in two different compartments are in fact two different pools.


\subsubsection{Generalisation}

\begin{itemize}
\item \classref{SBGNGlyph}
\end{itemize}

\subsubsection{Attributes}

\begin{attributes}
  \attitem{name}{string} The name of the compartment.
  \attitem{natures}{cv} A set of controlled vocabularies that describes
  a characteristic of the compartment. Zero, one or more values may be
  set, but each one must belong to a different controlled vocabulary.
\end{attributes}

\subsubsection{Associations}

\begin{attributes}
  \associtem{epns}{\sbgnclass{EntityPoolNode}}{*} The
  \sbgnclass{EntityPoolNode}s contained by this compartment.
\end{attributes}

\subsubsection{Rules and Constraints}

\begin{itemize}
\item \attrib{name} must not be used by another instance of
  \sbgnclass{Container} contained by the same instance of
  \sbgnclass{Map}.
\item \attrib{epns} must contain a unique set of
  \sbgnclass{EntityPoolNodes}. See section \ref{sec:epnuniqueness} for
  the definition of \sbgnclass{EntityPoolNode} uniqueness.
\end{itemize}

\subsubsection{Notation}

\paragraph{Glyph: \glyph{Compartment}}\label{sec:compartment}

\begin{glyphDescription}

\glyphSboTerm  SBO:0000290 ! physical compartment 

\glyphContainer A compartment is represented by a surface enclosed in a continuous border or located between continuous borders. These borders should be noticeably thicker than the borders of the EPNs. A compartment can take \textbf{any} geometry. A compartment must always be entirely enclosed.

\glyphLabel The identification of the compartment is carried by an unbordered box containing a string of characters. The characters can be distributed on several lines to improve readability, although this is not mandatory. The label box can be attached anywhere in the container box. Note that the label can spill-over from the container box.

\glyphAux A \glyph{compartment} can carry a certain number of \glyph{units of information}, that will add information for instance about the physical environment, such as pH, temperature or voltage, see \sect{unitInfo}.  The center of the bounding box of a \glyph{unit of information} is located on the mid-line of the border of the compartment.

\end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{images/compartment}
  \caption{The \PD glyph for \glyph{compartment}.}
  \label{fig:compartment}
\end{figure}


To allow more aesthetically pleasing and understandable maps, compartments are allowed to overlap each other visually, but it must be kept in mind that this does not mean the top compartment contains part of the bottom compartment.  \fig{overlap} shows two semantically equivalent placement of compartments:

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.4]{examples/compartment_overlapping}
  \caption{Overlapped compartments are permitted, but the overlap does not imply containment.}
  \label{fig:overlap}
\end{figure}

Overlapped (hidden) part of the compartment should not contain any object which could be covered by an overlapping compartment.  \fig{overlap-bad} illustrates the problem using an incorrect map.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.45]{examples/compartment_overlapping_wrong}
  \caption{Example of an \textbf{incorrect} map.  Overlapped compartments must not obscure other objects.}
  \label{fig:overlap-bad}
\end{figure}

% It is important to note that a compartment never contains another compartment, but may surround it.  A key aspect of correctly drawing two ``adjacent'' compartments is that they are not separated by one line, but by \textbf{two} lines.  \fig{two-comp} provides an example of this in which a cell is shown made up of a nucleus surrounded by the cytoplasm.

% \begin{figure}[H]
%   \centering
%   \includegraphics[scale = 0.4]{examples/compartment-cell}
%  \includegraphics[scale = 0.4]{examples/compartment-cell-wrong}
%   \caption{Compartments can surround other compartments; in that case, both of the compartment's borders must still be shown, with the result that the separation is drawn as two lines. The left example is correct, with twoo disjoint compartments representing the ``cytoplasm'' and the ``nucleus''. The right example is incorrect. Indeed the compartments ``cell'' and ``nucleus'' would be disjoint, the latter only overlapping the former. As a result, the volume of the nucleus is duplicated.}
%   \label{fig:two-comp}
% \end{figure}

% The example diagram in \fig{three-comp} represents three adjacent compartments.  Two of the compartments carry units of information.  Notice that these units of information do not overlap multiple membrane boundaries.

% \begin{figure}[H]
%   \centering
%   \includegraphics[scale = 0.4]{examples/compartment-3comp}
%   \caption{Illustration of units of information and surrounding compartments.}
%   \label{fig:three-comp}
% \end{figure}

\subsubsection{Changes from Previous Version}

No changes from previous the version.

\subsection{AttributeValue}
\label{defn:AttributeValue}

\begin{figure}[htb]
  \centering
  \includegraphics[width = 0.5\textwidth]{images/attributevalueuml}
  \caption{The UML definition of the \sbgnclass{AttributeValue} and
    its usage by other classes.}
  \label{fig:attributevalueuml}
\end{figure}

 The \sbgnclass{AttributeValue} is used to present the values of
 certain attributes held by other SBGN elements. It is typically
 contained and owned by the class containing the attribute (or its
 descendants). It contains two values, one is a \attrib{code} to indicate the
 attribute that is defined and the other is the\attrib{ value} itself. The \attrib{code}
 and the presentation format of the \attrib{value} are defined by the
 SBGN element that contains the \sbgnclass{AttributeValue}, currently
 \classref{Compartment}, \classref{EntityPoolNode}, and \classref{Subunit}.


\subsubsection{Generalisation}

\begin{itemize}
\item \classref{AuxiliaryUnit}
\end{itemize}

\subsubsection{Attributes}

\begin{attributes}
  \attitem{code}{string} The code indicating the attribute that is
  being presented.
  \attitem{value}{object} The value of the attribute. The format of
  the value is determined by the class holding the attribute.
\end{attributes}

\subsubsection{Associations}

No additional associations.

\subsubsection{Rules and Constraints}

No additional rules and constraints.

\subsubsection{Notation}

For historical reasons the \sbgnclass{AttributeValue} is represented
graphically by the glyph \glyph{Unit of Information}.

\paragraph{Glyph: \glyph{Unit of information}}
\label{sec:unitInfo}

When representing biological entities, it is often necessary to convey
some abstract information about the entity's function that cannot (or
does not need to) be easily related to its structure.  The \glyph{unit
  of information} is a decoration that can be used in this situation
to add information to a glyph.  Some example uses include:
characterizing a logical part of an entity such as a functional domain
(a binding domain, a catalytic site, a promoter, etc.), or the
information encoded in the entity (an exon, an open reading frame,
etc.).  A \glyph{unit of information} can also convey information
about the physical environment, or the specific type of biological
entity it is decorating.

\begin{glyphDescription}

\glyphSboTerm Not applicable.

\glyphContainer A unit of information is represented by a rectangle.  The long side of the rectangle should be oriented parallel to the border of the \glyph{EPN} being annotated by the \glyph{unit of information}. The center of the bounding box of a \glyph{state of information} should be located on the mid-line of the border of the \glyph{EPN}.

\glyphLabel A \glyph{unit of information} is identified by a label placed in an unbordered box containing a string of characters.  The characters can be distributed on several lines to improve readability, although this is not mandatory.  The label box must be attached to the center of the container.  The label may spill outside of the container.


%\glyphAux A \glyph{unit of information} does not carry any auxiliary items.  

\end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{images/unitInformation}
  \caption{The \PD glyph for \glyph{unit of information}.}
  \label{fig:unitInfo}
\end{figure}


\subsubsection{Changes from Previous Version}


\subsection{StateVariable}

\subsubsection{Glyph: \glyph{State variable}}
\label{sec:stateVariable}

Many biological entities such as molecules can exist in different \emph{states}, meaning different physical or informational configurations.  These states can arise for a variety of reasons.  For example, macromolecules can be subject to post-synthesis modifications, wherein residues of the macromolecules (amino acids, nucleosides, or glucid residues) are modified through covalent linkage to other chemicals.  Other examples of states are alternative conformations as in the closed/open/desensitized conformations of a transmembrane channel, and the active/inactive forms of an enzyme.

SBGN provides a means of associating one or more \glyph{state variables} with an entity; each such variable can be used to represent a dimension along which the state of the overall entity can vary.  When an entity can exist in different states, the state of the whole entity (\ie the SBGN object) can be described by the current values of all its \glyph{state variables}, and the values of the \glyph{state variables} of all its possible components, recursively.

\begin{glyphDescription}
\item[Identifying Attributes:]\mbox{}
  \begin{itemize}
  \item owning EPN
  \item name (optional)
  \item value
 \end{itemize}
\item[Special constraints or rules:]\mbox{}\newline None.
\end{glyphDescription}

\begin{glyphDescription}

\glyphSboTerm Not applicable.

\glyphContainer A \glyph{state variable} is represented by a '``stadium'' container, that is two hemicercles of same radius joined by parallel segments, as shown in \fig{state-var}.  The parallel segment axis should be tangent to the border of the glyph of the \glyph{EPN} being modified by the \glyph{state variable}. The center of the bounding box of a \glyph{state variable} should be located on the mid-line of the border of the \glyph{EPN}.

\glyphLabel The identification of an instance of a \glyph{state variable} is carried by one or two unbordered boxes, each containing a string of characters.  The characters cannot be distributed on several lines.  One box is mandatory, and contains the value of the \glyph{state variable}.  The value may be empty; an example of a situation where this might arise is an unphosphorylated phosporylation site.  The second box is optional and carries the identification of the \glyph{state variable}. The center of the combination of the boxes located in the container box is superposed to the center of this container box.  In earier version of the \PD specification, the identification of the \glyph{state variable} could be located outside the \glyph{state variable} container box.  This is now forbidden.  The style of labeling of \glyph{state variables} encouraged by \SBGNPDLone is to combine a prefix representing the value of the variable with a suffix representing the variable's name.  Prefix and suffix should be separated by the symbol '@', X@Y thus meaning \emph{value X} AT \emph{variable Y}. The label of a \glyph{state variable} should, if possible, be displayed within the boundary of the glyph.

\glyphAux A \glyph{state variable} does not carry any auxiliary items.  

\glyphCloning Not cloned.

\end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3, trim = 0 0 0 0.25in]{images/stateVariable}
  \caption{Examples of the \PD glyph for \glyph{state variable}.}
  \label{fig:state-var}
\end{figure}

A \glyph{state variable} does not necessarily have to be Boolean-valued.  For example, an ion channel can possess several conductance states; a receptor can be inactive, active and desensitized; and so on.  As another example, a \glyph{state variable} ``ubiquitin'' could also carry numerical values corresponding to the number of ubiquitin molecules present in the tail.  However, in all cases, a \glyph{state variable} on an EPN can only take \emph{one} defined value.  Further, an EPN's \glyph{state variable} should always be displayed and always set to a value.  An ``empty'' \glyph{state variable} is a \glyph{state variable} that is set to the value ``unset'', it is not a \glyph{state variable} with no value. Note that the value ``unset'' is \emph{not} synonymous to ``any value'' or ``unknown value''.


\subsubsection{Glyph: \glyph{Annotation}}

\SBGNPDLone defines a glyph to add additional information to a map, that does not modify the semantic of the the graph. This glyph can be used to add free text, or links to external information.

\begin{glyphDescription}

\glyphSboTerm SBO:NEW

\glyphContainer An \glyph{annotation} is represented by a rectangular container with a folded corner, as illustrated in \fig{annotation}. This container is linked to the annotated element in a way that cannot be mistaken for a relationship, for instance a callout, a thick edge, a dashed line etc. The link ends up on the border of the annotated element.

\glyphLabel An \glyph{annotation} contains information placed in an unbordered box containing a string of characters.  The characters can be distributed on several lines to improve readability, although this is not mandatory.  The label box must be attached to the center of the container. The label may spill outside of the container. 

\glyphAux An \glyph{annotation} does not carry any auxiliary unit.
\end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{images/annotation}
  \caption{The \PD glyph for \glyph{annotation}.}
  \label{fig:annotation}
\end{figure}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{examples/ex-annotation}
  \caption{Example of \glyph{annotations} adding information to the description of the trans-phosphorylation of CaMKII. Note that three different types of links are used between annotation nodes and annotated elements. However, it is recommended to use a consistent scheme whithin a map.}
  \label{fig:ex-annotation}
\end{figure}

\subsection{Reference nodes}

Reference nodes handle links or relationships between elements of a
map and sub-map. At present there is only one reference glyph,
\glyph{tag}, which can be used in a map refered to by a \glyph{submap}
(\sect{submap}) or as an auxilary unit on the \glyph{submap}. The
\glyph{clone marker} can also provide additional reference mechanisms
and is discussed below (\sect{cloneMarker}).


\subsubsection{Glyph: \glyph{Tag}}
\label{sec:tag}

A \glyph{tag} is a named handle, or reference, to another EPN (\sect{EPNs}) or compartment (\sect{compartment}).  \glyph{Tags} are used to identify those elements in \glyph{submaps} (\sect{submap}).

\begin{glyphDescription}

\glyphSboTerm Not applicable.

\glyphContainer A \glyph{tag} is represented by a rectangle fused to an empty arrowhead, as illustrated in \fig{tag}.  The symbol should be linked to one and only one edge (\ie it should reference only one EPN or compartment).

\glyphLabel A \glyph{tag} is identified by a label placed in an unbordered box containing a string of characters.  The characters can be distributed on several lines to improve readability, although this is not mandatory.  The label box must be attached to the center of the container. The label may spill outside of the container.

\glyphAux A \glyph{tag} does not carry any auxiliary items. 

\end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{images/tag}
  \caption{The \PD glyph for \glyph{tag}.}
  \label{fig:tag}
\end{figure}

\subsection{Arcs}\label{sec:arcs}

Arcs are lines that link \glyph{EPNs} and \glyph{PNs} together.  The symbols attached to their extremities indicate their semantics.

\subsection{Process Arcs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Consumption
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Glyph: \glyph{Consumption}}
\label{sec:consumption}

\glyph{Consumption} is the arc used to represent the fact that an entity pool is consumed by a process,
but is not produced by the process.

\begin{glyphDescription}
 \glyphSboTerm SBO:0000394 ! consumption.
 \glyphOrigin Any \glyph{EPN} (\sect{EPNs}).
 \glyphTarget Any \glyph{process node} (\sect{PNs}).
 \glyphEndPoint No particular symbol is used to represent a consumption.
\end{glyphDescription}


A cardinality label may be associated with \glyph{consumption} (\sect{consumption}) or 
\glyph{production} (\sect{production}) arcs, indicating the stoichiometry of a process. This label is a number enclosed in a rectangle with one of the long sides adjacent to the consumption arc. The cardinality is 
required to eliminate ambiguity when the exact composition, or the number of 
copies, of the inputs or outputs to a reaction are ambiguous from the map. 
An example is a multimer of 6 subunits dissociating into 2 monomers and 2 
dimers. Without stoichiometry labels another result, such as 4 monomers and 1 
dimer could be inferred.
Once assigned to one arc connecting to a process node, cardinality should be represented on
all \glyph{consumption} and \glyph{production} arcs connected to that process
node to avoid misinterpretation.

Omitted cardinality on one edge only should not be treated as cardinality of 1, but
as an unspecified cardinality. In most cases, the exact value may be derived from the
context, but unless cardinality is explicitly shown, it should be considered as
unspecified. In the case where the stoichiometry of some part of the process is not
known, or undefined, a question mark (?) should be used within the cardinality label
of the corresponding arcs.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.4]{images/consumption}
  \caption{The \PD glyph for \glyph{consumption}.}
  \label{fig:consumption}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Production
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Glyph: \glyph{Production}}\label{sec:production}

\glyph{Production} is the arc used to represent the fact that an entity pool is 
produced by a process. In the case of a reversible process, the 
\glyph{production} arc also acts as a \glyph{consumption} arc.

\begin{glyphDescription}
 \glyphSboTerm SBO:0000393 ! production.
 \glyphOrigin Any \glyph{process node} (\sect{PNs}).
 \glyphTarget Any \glyph{EPN} (\sect{EPNs}).
 \glyphEndPoint The target extremity of a \glyph{production} carries a filled arrowhead.
 \end{glyphDescription}

A cardinality label can be associated with a \glyph{production} arc indicating the stoichiometry of a process.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.4]{images/production}
  \caption{The \PD glyph for \glyph{production}.}
  \label{fig:production}
\end{figure}

\fig{prod-card} illustrates the use of consumption/production arc cardinality labels to represent the stoichiometry of a process.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.85]{examples/stoichEx1}
  \caption{Cardinality for production arcs.}
  \label{fig:prod-card}
\end{figure}

\subsection{ModulationArc}
\label{defn:ModulationArc}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Modulation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Glyph: \glyph{Modulation}}\label{sec:modulation}

A modulation affects the flux of a process
represented by the target process. Such a modulation can affect the
process \textbf{positively or negatively}, or even both ways depending on the
conditions, for instance the concentration of the intervening
participants. A \glyph{modulation} can also be used when one does not know the precise direction of the effect.

\begin{glyphDescription}
 \glyphSboTerm SBO:0000168 ! control.
 \glyphOrigin Any \glyph{EPN} (\sect{EPNs}) or any \glyph{logical operator} (\sect{logic}).
 \glyphTarget Any \glyph{process node} (\sect{PNs}).
 \glyphEndPoint The target extremity of a \glyph{modulation} carries an empty diamond.
 \end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{images/modulation}
  \caption{The \PD glyph for \glyph{modulation}.}
  \label{fig:modulation}
\end{figure}

\fig{modul-nico} represents the effect of nicotine on the process between closed and open states of a nicotinic acetylcholine receptor. High concentrations of nicotine open the receptor while low concentrations can desensitize it without opening. 

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{examples/modulation-nAChR}
  \caption{Modulation of nicotinic receptor opening by nicotine.}
  \label{fig:modul-nico}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Stimulation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Glyph: \glyph{Stimulation}}\label{sec:stimulation}

A stimulation affects \textbf{positively} the flux of a process represented by the target process. This stimulation can be for instance a catalysis or a positive allosteric regulation. Note that \glyph{catalysis} exists independently in SBGN, see \sect{catalysis}.

\begin{glyphDescription}
 \glyphSboTerm SBO:0000170 ! stimulation.
 \glyphOrigin Any \glyph{EPN} (\sect{EPNs}) or any logical operator (\sect{logic}).
 \glyphTarget Any \glyph{process node} (\sect{PNs}).
 \glyphEndPoint The target extremity of a \glyph{stimulation} carries an empty arrowhead.
 \end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{images/stimulation}
  \caption{The \PD glyph for \glyph{stimulation}.}
  \label{fig:stimulation}
\end{figure}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Catalysis
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Glyph: \glyph{Catalysis}}\label{sec:catalysis}

A catalysis is a particular case of stimulation, where the effector affects
positively the flux of a process represented by the target process. The positive effect on the process is due to the lowering of the activation energy of a reaction.

\begin{glyphDescription}
 \glyphSboTerm SBO:0000172 ! catalysis.
 \glyphOrigin Any \glyph{EPN} (\sect{EPNs}) or any \glyph{logical operator} (\sect{logic}).
 \glyphTarget Any \glyph{process node} (\sect{PNs}).
 \glyphNode The target extremity of a \glyph{catalysis} carries an empty circle.
 \end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{images/catalysis}
  \caption{The \PD glyph for \glyph{catalysis}.}
  \label{fig:catalysis}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Inhibition
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Glyph: \glyph{Inhibition}}\label{sec:inhibition}

An inhibition \textbf{negatively} affects the flux of a process represented by the target process. This inhibition can be for instance a competitive inhibition or an allosteric inhibition. 

\begin{glyphDescription}
 \glyphSboTerm SBO:0000169 ! inhibition.
 \glyphOrigin Any \glyph{EPN} (\sect{EPNs}) or any \glyph{logical operator} (\sect{logic}).
 \glyphTarget Any \glyph{process node} (\sect{PNs}).
 \glyphNode The target extremity of an \glyph{inhibition} carries a bar perpendicular to the arc.
 \end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{images/inhibition}
  \caption{The \PD glyph for \glyph{inhibition}.}
  \label{fig:inhibition}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Necessary_Stim
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Glyph: \glyph{Necessary stimulation}}\label{sec:necessary_stim}

A necessary stimulation, is one that is necessary for a process to take place. A process modulated by a necessary stimulation can only occur when this necessary stimulation is active.

\begin{glyphDescription}
 \glyphSboTerm SBO:0000171 ! necessary stimulation.
 \glyphOrigin Any \glyph{EPN} (\sect{EPNs}) or any \glyph{logical operator} (\sect{logic}).
 \glyphTarget Any \glyph{process node} (\sect{PNs}).
 \glyphNode The target extremity of a \glyph{necessary stimulation} carries an open arrow (to remind that it is a \glyph{stimulation}) coming after a larger vertical bar.
 \end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{images/necessary_stim}
  \caption{The \PD glyph for \glyph{Necessary Stimulation}.}
  \label{fig:Necessary Stimulation}
\end{figure}

The example in \fig{necessary_stim-gene} below describes the transcription of a gene~X, that is the creation of a messenger RNA~X triggered by the gene~X.  The creation of the protein~X is then triggered by the mRNA~X.  (Note that the same example could be represented using the gene as reactant and product, although it is semantically different.)

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.4]{examples/necessary_stim-genetic}
  \caption{The creation of a messenger RNA~X triggered by the gene~X.}
  \label{fig:necessary_stim-gene}
\end{figure}


The example in \fig{necessary_stim-calcium} below describes the transport of calcium ions out of the endoplasmic reticulum. Without IP3 receptor, there is not calcium flux, therefore, one cannot use a \glyph{stimulation}. The Necessary Stimulation instead represents this absolute stimulation.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{examples/necessary_stim-transport}
  \caption{The transport of calcium ions out of the endoplasmic reticulum into the cytosol. Note that IP3R crosses both compartment boundaries. This is allowed, but the Macromolecule should only belong to one of the compartments see section \ref{sec: unresolved multi-comp ents} for more discussion of this issue.}
  \label{fig:necessary_stim-calcium}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Logic arc
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{LogicArc}
\label{defn:LogicArc}

\paragraph{Glyph: \glyph{Logic arc} }\label{sec:logicArc}

\glyph{Logic arc} is used to represent the fact that an entity influences
the outcome of a logic operator. 

\begin{glyphDescription}
 \glyphSboTerm SBO:0000398 ! logical relationship.
 \glyphOrigin Any \glyph{EPN} (\sect{EPNs}) or \glyph{logical operator} (\sect{logic}).
 \glyphTarget Any \glyph{logical operator} (\sect{logic}).
 \glyphEndPoint No particular symbol is used to represent a logic arc.
 \end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.4]{images/logicArc}
  \caption{The \PD glyph for \glyph{logic arc}.}
  \label{fig:logicArc}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                     Equivalence Arc
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Glyph: \glyph{Equivalence arc} }\label{sec:equivalenceArc}

\glyph{Equivalence arc} is the arc used to represent the fact that all entities
marked by a \glyph{tag} are equivalent. 

\begin{glyphDescription}
 \glyphSboTerm Not applicable.
 \glyphOrigin Any \glyph{EPN} (\sect{EPNs}).
 \glyphTarget \glyph{Tag} (\sect{tag}).
 \glyphEndPoint No particular symbol is used to represent an \glyph{equivalence arc}.
 \end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.4]{images/equivalence}
  \caption{The \PD glyph for \glyph{Equivalence arc}.}
  \label{fig:equivalence}
\end{figure}

\section{Decorators}

\subsection{Glyph: \glyph{Clone marker}}
\label{sec:cloneMarker}

If an \glyph{EPN} is duplicated on a map, it is necessary to indicate this fact by using the \glyph{clone marker} auxiliary unit.  The purpose of this marker is to provide the reader with a visual indication that this node has been cloned, and that at least one other occurrence of the \glyph{EPN} can be found in the map (or in a submap; see \sect{submap}).  The clone marker takes two forms, simple and labeled, depending on whether the node being cloned can carry state variables (\ie whether it is a stateful EPN). Note that an \glyph{EPN} belongs to a single compartment. If two glyphs labelled ``X'' are located in two different compartments, such as ATP in cytosol and ATP in mitochondrial lumen, they represent different \glyph{EPNs}, and therefore do not need to be marked as cloned.


\subsubsection{Simple clone marker}

As mentioned above, the \glyph{simple clone marker} is the unlabeled version of the \glyph{clone marker}.  See below for the labeled version.


\begin{glyphDescription}

\glyphSboTerm Not applicable.

\glyphContainer The simple (unlabeled) \glyph{clone marker} is a portion of the surface of an \glyph{EPN} that has been modified visually through the use of a different shade, texture, or color.  \fig{simpleCloneMarker} illustrates this.  The \glyph{clone marker} occupies the lower part of the \glyph{EPN}. The filled area must be smaller than the unfilled one.

\glyphLabel Not applicable.

\glyphAux A \glyph{clone marker} does not carry any auxiliary items.

\end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{images/simpleCloneMarker}
  \caption{The \PD glyph for \glyph{simple clone marker} applied to a \glyph{simple chemical} and a \glyph{multimer} of \glyph{simple chemicals}.}
  \label{fig:simpleCloneMarker}
\end{figure}


\subsubsection{Labeled clone marker}

Unlike the \glyph{simple clone marker}, the \glyph{labeled clone marker} includes (unsurprisingly, given its name) an identifying label that can be used to identify equivalent clones elsewhere in the map.  This is particularly useful for stateful \glyph{EPNs}, because these can have a large number of state variables displayed and therefore may be difficult to visually identify as being identical.

\begin{glyphDescription}

\glyphSboTerm Not applicable.

\glyphContainer The labeled \glyph{clone marker} is a portion of the surface of an \glyph{EPN} that has been modified visually through the use of a different shade, texture, or color.  The \glyph{clone marker} occupies the lower part of the EPN glyph. The filled area must be smaller than the unfilled one, but the be large enough to have a height larger than the \glyph{clone marker}'s label (cf below).  

\glyphLabel A \glyph{clone marker} is identified by a label placed in an unbordered box containing a string of characters.  The characters can be distributed on several lines to improve readability, although this is not mandatory.  The label box must be attached to the center of the container.  The label may spill outside of the container (the portion of the surface of the EPN that has been modified visually).  The font color of the label and the color of the clone marker should contrast with one another.  The label on a \glyph{labeled clone marker} is mandatory.

\glyphAux A \glyph{clone marker} does not carry any auxiliary items.

\end{glyphDescription}

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.3]{images/labeledCloneMarker}
  \caption{The \PD glyph for \glyph{labeled clone marker} applied to a \glyph{macromolecule}, a \glyph{nucleic acid feature} and a \glyph{multimer} of \glyph{macromolecules}.}
  \label{fig:labeledCloneMarker}
\end{figure}

\fig{example-cloning} contains an example in which we illustrate the use of \glyph{clone markers} to clone the species ATP and ADP participating in different reactions.  This example also demonstrates the chief drawbacks of using clones: it leads to a kind of dissociation of the overall network and multiplies the number of nodes required, requiring more work on the part of the reader to interpret the result.  Sometimes these disadvantages are offset in larger maps by a reduction in the overall number of line crossings, but not always.  In general, we advise that cloning should be used sparingly.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.5]{examples/cloning}
  \caption{An example of using cloning, here for the species ATP and ADP.}
  \label{fig:example-cloning}
\end{figure}

\section{Controlled vocabularies}\label{sec:CVs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%                   Controlled vocabularies
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Some glyphs in SBGN \PDs can contain particular kinds of textual annotations conveying information relevant to the purpose of the glyph.  These annotations are \glyph{units of information} (\sect{unitInfo}) or \glyph{state variable}  (\sect{stateVariable}).  An example is in the case of multimers, which can have a unit of information conveying the number of monomers composing the multimer.  Other cases are described throughout the rest of this chapter.

The text that appears as the unit of information decorating an Entity Pool Node (EPN) must in most cases be prefixed with a controlled vocabulary term indicating the type of information being expressed.  The prefixes are mandatory except in the case of macromolecule covalent modifications (\sect{covalent-mod-cv}).  Without the use of controlled vocabulary prefixes, it would be necessary to have different glyphs to indicate different classes of information; this would lead to an explosion in the number of symbols needed.

In the rest of this section, we describe the controlled vocabularies (CVs) used in \SBGNPDLone.  They cover the following categories of information: an EPN's material type, an EPN's conceptual type, covalent modifications on macromolecules, the physical characteristics of compartments, and cardinality (\eg of multimers).  In each case, some CV terms are predefined by SBGN, but unless otherwise noted, \emph{they are not the only terms permitted}.  Authors may use other CV values not listed here, but in such cases, they should explain the term's meanings in a figure legend or other text accompanying the map.


\subsection{Entity pool node material types}
\label{sec:material-types-cv}

The material type of an EPN indicates its chemical structure.  A list of common material types is shown in \tab{material-types-cv}, but others are possible.  The values are to be taken from the \sbo (\sbourl), specifically from the branch having identifier \sboid{SBO:0000240} ($\!$\emph{material entity} under \emph{entity}).  The labels are defined by \SBGNPDLone.

\begin{table}[h]
  \centering
  \begin{tabular}{l>{\ttfamily}l>{\ttfamily}l}
    \toprule
    \textbf{Name}              & \textbf{\rmfamily Label} & \textbf{\rmfamily SBO term} \\
    \midrule
    Non-macromolecular ion     & mt:ion  & SBO:0000327\\
    Non-macromolecular radical & mt:rad  & SBO:0000328\\
    Ribonucleic acid           & mt:rna  & SBO:0000250\\
    Deoxribonucleic acid       & mt:dna  & SBO:0000251\\
    Protein                    & mt:prot & SBO:0000297\\
    Polysaccharide             & mt:psac & SBO:0000249\\
    \bottomrule
  \end{tabular}
  \caption{A sample of values from the \emph{material types} controlled
    vocabulary (\sect{material-types-cv}).}
  \label{tab:material-types-cv}
\end{table}

The material types are in contrast to the \emph{conceptual types} (see below).  The distinction is that material types are about physical composition, while conceptual types are about roles.  For example, a strand of RNA is a physical artifact, but its use as messenger RNA is a role.


\subsection{Entity pool node conceptual types}
\label{sec:conceptual-types-cv}

An EPN's \emph{conceptual type} indicates its function within the context of a given \PD.  A list of common conceptual types is shown in \tab{conceptual-types-cv}, but others are possible.  The values are to be taken from the \sbo (\sbourl), specifically from the branch having identifier \sboid{SBO:0000241} ($\!$\emph{conceptual entity} under \emph{entity}).  The labels are defined by \SBGNPDLone.

\begin{table}[h]
  \centering
  \begin{tabular}{l>{\ttfamily}l>{\ttfamily}l}
    \toprule
    \textbf{Name}              & \textbf{\rmfamily Label} & \textbf{\rmfamily SBO term} \\
    \midrule
    Gene                      & ct:gene   & SBO:0000243\\
    Transcription start site  & ct:tss    & SBO:0000329\\
    Gene coding region        & ct:coding & SBO:0000335\\
    Gene regulatory region    & ct:grr    & SBO:0000369\\
    Messenger RNA             & ct:mRNA   & SBO:0000278\\
    \bottomrule
  \end{tabular}
  \caption{A sample of values from the \emph{conceptual types} vocabulary
    (\sect{conceptual-types-cv}).}
  \label{tab:conceptual-types-cv}
\end{table}


\subsection{Macromolecule covalent modifications}
\label{sec:covalent-mod-cv}

A common reason for the introduction of state variables (\sect{stateVariable}) on an entity is to allow access to the configuration of possible covalent modification sites on that entity.  For instance, a macromolecule may have one or more sites where a phosphate group may be attached; this change in the site's configuration (\ie being either phosphorylated or not) may factor into whether, and how, the entity can participate in different processes.  Being able to describe such modifications in a consistent fashion is the motivation for the existence of SBGN's covalent modifications controlled vocabulary.  

\tab{covalent-mod-cv} lists a number of common types of covalent modifications.  The most common values are defined by the \sbo in the branch having identifier \sboid{SBO:0000210} (\emph{addition of a chemical group} under \emph{interaction}$\rightarrow$\emph{process}$\rightarrow$\emph{biochemical or transport reaction}$\rightarrow$\\\emph{biochemical reaction}$\rightarrow$\emph{conversion}).  The labels shown in \tab{covalent-mod-cv} are defined by \SBGNPDLone; for all other kinds of modifications not listed here, the author of a \PD must create a new label (and should also describe the meaning of the label in a legend or text accompanying the map).

\begin{table}[h]
  \centering
  \begin{tabular}{l>{\ttfamily}l>{\ttfamily}l}
    \toprule
    \textbf{Name}   & \textbf{\rmfamily Label} & \textbf{\rmfamily SBO term} \\
    \midrule
    Acetylation     & Ac    & SBO:0000215\\
    Glycosylation   & G     & SBO:0000217\\
    Hydroxylation   & OH    & SBO:0000233\\
    Methylation     & Me    & SBO:0000214\\
    Myristoylation  & My    & SBO:0000219\\
    Palmytoylation  & Pa    & SBO:0000218\\
    Phosphorylation & P     & SBO:0000216\\
    Prenylation     & Pr    & SBO:0000221\\
    Protonation     & H     & SBO:0000212\\
    Sulfation       & S     & SBO:0000220\\
    Ubiquitination  & Ub    & SBO:0000224\\
    \bottomrule
  \end{tabular}
  \caption{A sample of values from the \emph{covalent modifications} vocabulary
    (\sect{covalent-mod-cv}).}
  \label{tab:covalent-mod-cv}
\end{table}


\subsection{Physical characteristics}
\label{sec:physical-characteristics-cv}

\SBGNPDLone defines a special unit of information for describing certain common physical characteristics.  \tab{physical-characteristics-cv} lists the particular values defined by \SBGNPDLone.  %
%The values correspond to the \sbo branch with identifier \sboid{SBO:0000255} (\emph{physical characteristic} under \emph{quantitative parameter}).
It is anticipated that these will be used to describe the nature of a \glyph{perturbing agent} (section \ref{sec:perturbing agent}) or a \glyph{phenotype} (section \ref{sec:phenotype}).

\begin{table}[h]
  \centering
  \begin{tabular}{l>{\ttfamily}l>{\ttfamily}l}
    \toprule
    \textbf{Name}   & \textbf{\rmfamily Label} & \textbf{\rmfamily SBO term} \\
    \midrule
    Temperature   & pc:T  & SBO:0000147\\
    Voltage       & pc:V  & SBO:0000259\\
    pH            & pc:pH & SBO:0000304\\
    \bottomrule
  \end{tabular}
  \caption{A sample of values from the \emph{physical
      characteristics} vocabulary (\sect{physical-characteristics-cv}).}
  \label{tab:physical-characteristics-cv}
\end{table}


\subsection{Cardinality}
\label{sec:cardinality-cv}

\SBGNPDLone defines a special unit of information usable on multimers for describing the number of monomers composing the multimer.  \tab{cardinality-cv} shows the way in which the values must be written.  Note that the value is an positive non-zero integer, and not (for example) a range.  There is no provision in \SBGNPDLone for specifying a range in this context because it leads to problems of entity identifiability.

\begin{table}[h]
  \centering
  \begin{tabular}{l>{\ttfamily}l>{\ttfamily}l}
    \toprule
    \textbf{Name}   & \textbf{\rmfamily Label} & \textbf{\rmfamily SBO term} \\
    \midrule
    cardinality    & N:\#  & SBO:0000364\\
    \bottomrule
  \end{tabular}
  \caption{The format of the possible values for the
    \emph{cardinality} unit of information
    (\sect{cardinality-cv}).  Here, \texttt{\#} stands for the
    number; for example, ``\texttt{N:5}''.}
  \label{tab:cardinality-cv}
\end{table}


\section{Map and Submap Linking}

A \sbgnclass{Submap} is used to encapsulate processes (including all
types of nodes and edges) one glyph.  The \glyph{submap} hides its
content to the users, and display only input terminals (or ports),
linked to \glyph{EPNs} (\sect{EPNs}).  A \glyph{submap} is not
equivalent to an \glyph{omitted process} (see \sect{omitted}).  In the
case of an SBGN description that is made available through a software
tool, the content of a \glyph{submap} may be available to the tool.  A
user could then ask the tool to expand the \glyph{submap}, for
instance by clicking on the icon representing the \glyph{submap}.  The
tool might then expand and show the \glyph{submap} within the same map
(on the same canvas), or it might open it in a different canvas. In
the case of an SBGN description made available in a book or a website,
the content of the \glyph{submap} may be available on another page,
possibly accessible via an hyperlink on the \glyph{submap}.

\fig{submap-folded} represents a \glyph{submap} that transforms
glucose into fructose-6-phosphate. The \glyph{submap} carries five
terminals, four linked to EPNs and one linked to a
\glyph{compartment}.  The latter is particularly important in the case
of EPNs present only in a \glyph{compartment} enclosed in a
\glyph{submap}, and that are not linked to terminals themselves.  Note
that the terminals do not define a ``direction'', such as input or
output.  The flux of the reactions is determined by the context.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.4]{examples/submap-folded}
  \caption{Example of a submap with contents elided.}
  \label{fig:submap-folded}
\end{figure}

The map in \fig{submap-unfolded} represents an unfolded version of a
\glyph{submap}.  Here, anything outside the \glyph{submap} has
disappeared, and the internal \glyph{tags} are not linked to the
corresponding external \glyph{terminals}.  Note the tag 5, linking the
compartment ``mito'' of the \glyph{submap} to the compartment ``mito''
outside the \glyph{submap}.  The compartment containing Glu6P is
implicitly defined as the same as the compartment containing Glu and
Fru6P.  There is no ambiguity because if Glu and Fru6P were in
different compartments, one of them should have been defined within
the \glyph{submap}.

\begin{figure}[H]
  \centering
  \includegraphics[scale = 0.35]{examples/submap-dissociated}
  \caption{Example of an unfolded submap. The unfolded submap corresponds to the folded submap of \fig{submap-folded}.}
  \label{fig:submap-unfolded}
\end{figure}


% The following is for [X]Emacs users.  Please leave in place.
% Local Variables:
% TeX-master: "../sbgn_PD-level1"
% End:
