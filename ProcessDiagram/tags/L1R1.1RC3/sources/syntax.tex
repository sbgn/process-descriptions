\section{Syntax}

The syntax of the SBGN \PDl is defined in the form of an incidence matrix. 
An incidence matrix has arcs as rows and nodes as columns. Each element of the matrix represents the role of an arc in connection to a node. Input (I) means that the arc can begin at that node. Output (O) indicates that the arc can end at that node. Numbers in parenthesis represent the maximum number of arcs of a particular type to have this specific connection role with the node. Empty cells means the arc is not able to connect to the node.

For simplicity Logical operators are treated as EPNs.

\subsection{Entity Pool Nodes connectivity definition}  
\begin{tabular}{||c|c|c|c|c|c|c|c|c|c|c|c|c||}
\hline
\hline
\raisebox{20pt}{$Arc \backslash EPN$} &\vglyph{macromolecule} & \vglyph{simple chemical} & 
\vglyph{unspecified entity} &  \vglyph{multimer} & \vglyph{complex} & 
\vglyph{nucleic acid feature}& \vglyph{tag} & \vglyph{source} & \vglyph{sink} &  
\vglyph{perturbing agent} &  \vglyph{phenotype} & \vglyph{submap}\\ \hline 
\glyph{consumption}      & I & I & I & I & I & I &   & I &   &   & & \\ \hline 
\glyph{production}        & O & O & O & O & O & O &   & & O &   &   & \\ \hline 
\glyph{modulation}        & I & I & I & I & I & I &   &   & & I & O & \\ \hline 
\glyph{stimulation}        & I & I & I & I & I & I &   &   & & I & O & \\ \hline 
\glyph{catalysis}          & I & I & I & I & I &   &   &   & & I & O & \\ \hline 
\glyph{inhibition}          & I & I & I & I & I & I &   &   & & I & O & \\ \hline 
\glyph{necessary stimulation} & I & I & I & I & I & I &   &  &  & I & O & \\ \hline 
\glyph{logic arc}          & I & I & I & I & I & I &   &   &   &   & & \\ \hline 
\glyph{equivalence arc}     & I & I & I & I & I & I & O &   &  &  &   &O \\ \hline \hline
\end{tabular}


\subsection{Process Nodes connectivity definition}

\begin{tabular}{||c|c|c|c|c|c|c|c|c||}
\hline
\hline
\raisebox{20pt}{$Arc \backslash PN$} & \vglyph{process}  & \vglyph{omitted process}  & 
\vglyph{uncertain process} & \vglyph{association}  & \vglyph{dissociation}  & \vglyph{and}  &  
\vglyph{or} & \vglyph{not} \\ \hline 
\glyph{consumption} & O & O & O & O    & O(1) &      &      &      \\ \hline
\glyph{production}  & I & I & I & I(1) & I    &      &      &      \\ \hline
\glyph{modulation}  & O & O & O &      &      & I(1) & I(1) & I(1) \\ \hline
\glyph{stimulation} & O & O & O &      &      & I(1) & I(1) & I(1) \\ \hline
\glyph{catalysis}   & O & O & O &      &      & I(1) & I(1) & I(1) \\ \hline
\glyph{inhibition}  & O & O & O &      &      & I(1) & I(1) & I(1) \\ \hline
\glyph{necessary stimulation}     & O & O & O &      &      & I(1) & I(1) & I(1) \\ \hline
\glyph{logic arc}   &   &   &   &      &      & O    & O    & O(1) \\ \hline
\glyph{equivalence arc} &   &   &  &   &      &      &      &      \\ \hline \hline
\end{tabular}

\subsection{Containment definition}
There are three EPN types allowing containment of other EPN in SBGN: \glyph{compartment} and
\glyph{complex}. The next table describe relationship between EPN elements of SBGN
and these three containers. Plus sign means that the element is able to be
contained within a container. An empty cell means containment is not allowed.


\begin{tabular}{||c|c|c|c||}
\hline
\hline
$EPN \backslash Containers$  & \glyph{complex} & \glyph{compartment} & \glyph{submap} \\ \hline
\glyph{unspecified entity}    &         +       &          +          &        +       \\ \hline
\glyph{simple chemical}      &         +       &          +          &        +       \\ \hline
\glyph{macromolecule}        &         +       &          +          &        +       \\ \hline
\glyph{nucleic acid feature}   &         +       &          +          &        +       \\ \hline 
\glyph{multimer}             &         +       &          +          &        +       \\ \hline
\glyph{source}          &         -       &          +          &        +       \\ \hline 
\glyph{sink}          &         -       &          +          &        +       \\ \hline 
\glyph{perturbing agent}          &         -       &          +          &        +       \\ \hline
\glyph{phenotype}           &         -       &          +          &        +       \\ \hline
\glyph{tag}                  &         -       &          +          &        +       \\ \hline
\glyph{complex}              &         +       &          +          &        +       \\ \hline
\glyph{compartment}          &         -       &          -          &        +       \\ \hline
\glyph{submap}               &         -       &          +          &        +       \\ \hline
\glyph{process}             &         -       &          +          &        +       \\ \hline
\glyph{omitted process}      &         -       &          +          &        +       \\ \hline
\glyph{uncertain process}    &         -       &          +          &        +       \\ \hline
\glyph{association}          &         -       &          +          &        +       \\ \hline
\glyph{dissociation}         &         -       &          +          &        +       \\ \hline
\glyph{consumption}          &         -       &          +          &        +       \\ \hline
\glyph{production}           &         -       &          +          &        +       \\ \hline
\glyph{modulation}           &         -       &          +          &        +       \\ \hline
\glyph{stimulation}          &         -       &          +          &        +       \\ \hline
\glyph{catalysis}            &         -       &          +          &        +       \\ \hline
\glyph{inhibition}           &         -       &          +          &        +       \\ \hline
\glyph{necessary stimulation}   &         -       &          +          &        +       \\ \hline
\glyph{logic arc}            &         -       &          +          &        +       \\ \hline
\glyph{equivalence arc}      &         -       &          +          &        +       \\ \hline
\glyph{and}                  &         -       &          +          &        +       \\ \hline
\glyph{or}                   &         -       &          +          &        +       \\ \hline
\glyph{not}                  &         -       &          +          &        +       \\ \hline
\hline
\end{tabular}


\subsection{Syntactic rules}

There are additional syntactic rules that must be applied in addition to those defined above.

\subsubsection{EPNs}

 \begin{enumerate}
    \item If \glyph{macromolecule} has more than one \glyph{state variable}, 
    all \glyph{state variables} should have a name;
    \item All \glyph{state variables} of the \glyph{macromolecule} should have 
    different names;
    \item \glyph{Complex} should consists of different EPNs. If two or more 
    elements of the complex are identical they should be replaced by multimer. 
    \item An EPN that is a subunit of a \glyph{Complex} can only be linked to a modulation arc.
  \end{enumerate}

\subsubsection{\glyph{Source} and \glyph{Sink}}

 \begin{enumerate}
    \item Only one arc can be attached to these glyphs (degree 1).
  \end{enumerate}

\subsubsection{\glyph{Process}}
 \begin{enumerate}
    \item PN should have nonzero number of \glyph{consumption} links.
    \item PN should have nonzero number of \glyph{production} links.
    \item All substrates of the process should be different. If several 
    copies of the same EPN are involved in the process, cardinality label of 
    \glyph{consumption} arc should be used.
    \item All products of the process should be different. If several copies 
    of the same EPN are produced in the process, cardinality label of 
    \glyph{production} arc should be used.
    \item Once cardinality label set to one arc of the EPN all other arcs should
    make their cardinality visible, even if it is undefined. In a case
    cardinality is undefined or unknown question mark (``?'') should be placed as cardinality label. 
%    \item The EPN is not allowed to be a substrate and product of the same 
%    process. This rule is applicable to cloned EPNs as well.
    \item PN should have only one \glyph{Catalysis} arc connected to it. If
    there more than one catalyst known for the process several PNs should be
    drawn. 
    \item PN should have only one \glyph{Necessary Stimulation} arc connected to it. If
    there is more than one EPN acting as a necessary stimulator on a process then several a logic gate should be used.    \end{enumerate}  

\subsubsection{\glyph{Association}}

  \begin{enumerate}
    \item Composition of the \glyph{complex} or \glyph{multimer} produced by
    \glyph{association} should be identical to set of \glyph{association} substrates.
    \item If \glyph{association} produces \glyph{complex}, than number of 
    \glyph{consumption} arcs should be two or more.
    \item If \glyph{association} produces \glyph{multimer}, than it can have only one 
    \glyph{consumption} arc. In that case if substrate is not a
    \glyph{multimer}, then the number of monomers in a product \glyph{multimer}
    should be equal to cardinality of that arc. If substrate is another
    \glyph{multimer}, then cardinality of the consumption arc should be equal to
    ratio of number of monomers in product and in substrate \glyph{multimers}.
  \end{enumerate}  

\subsubsection{\glyph{Dissociation}}
  \begin{enumerate}
    \item Composition of \glyph{complex} or \glyph{multimer} consumed by
    \glyph{dissociation} should be identical to set of products of the process.
    \item If \glyph{complex} is consumed by the \glyph{dissociation}, than the
    process should have two or more \glyph{production} arcs.
    \item If \glyph{multimer} is split by \glyph{dissociation} process, than
    one \glyph{production} arc could be connected to the process node. In that case if product is not a
    \glyph{multimer}, then the number of monomers in a substrate \glyph{multimer}
    should be equal to cardinality of that arc. If product is another
    \glyph{multimer}, then cardinality of the \glyph{production} arc should be equal to
    ratio of number of monomers in substrate and in product \glyph{multimers}.
  \end{enumerate}  
  