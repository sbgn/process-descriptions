\section{Syntax}

The syntax of SBGN State Transition diagrams is defined in the form of an incidence matrix. 
An incidence matrix has arcs as rows and nodes as colums. Each element of the matrix represents the role of an arc in connection to a node. Input (I) means that the arc can begin at that node. Output (O) indicates that the arc can end at that node. Numbers in parenthesis represent the maximum number of arcs of a particular type to have this specific connection role with the node. Empty cells means the arc is not able to connect to the node.

For simplicity Logical operators are treated as PNs.

\subsection{SN connectivity definition}  
\begin{tabular}{||c|c|c|c|c|c|c|c|c|c|c|c||}
\hline
\raisebox{20pt}{$Arc \backslash SN$} &\vglyph{macromolecule} & \vglyph{simple chemical} &  
\vglyph{unspecified entity} & \vglyph{tag} & \vglyph{source/sink} &  \vglyph{perturbation} &  
\vglyph{observable} &  \vglyph{multimer} & \vglyph{complex} & \vglyph{genetic entity}& 
\vglyph{submap}\\ \hline 
\glyph{consumption} & I & I & I &  & I & & & I & I & I & \\ \hline
\glyph{production}  & O & O & O &   & O & &   & O & O & O & \\ \hline
\glyph{modulation}  & I & I & I &   &   & I & O & I & I & I & \\ \hline
\glyph{stimulation} & I & I & I &   &   & I & O & I & I & I & \\ \hline
\glyph{catalysis}   & I & I & I &   &   & I & O & I & I &   & \\ \hline
\glyph{inhibition}  & I & I & I &   &   & I & O & I & I & I & \\ \hline
\glyph{trigger}     & I & I & I &   &   & I & O & I & I & I & \\ \hline
\glyph{logic arc}     & I & I & I &   &&   && I & I & I & \\ \hline
\glyph{equivalence arc}     & I & I & I &O& & & & I & I & I &O \\ \hline \hline
\end{tabular}


\subsection{PN connectivity definition}

\begin{tabular}{||c|c|c|c|c|c|c|c|c|c|c||}
\hline
\raisebox{20pt}{$Arc \backslash TN$} & \vglyph{transition}  & \vglyph{omitted process}  & 
\vglyph{uncertain process} & \vglyph{association}  & \vglyph{dissociation}  & \vglyph{and}  &  
\vglyph{or} & \vglyph{not} \\ \hline 
\glyph{consumption} & O & O & O & O    & O(1) & O    & O    & O(1) \\ \hline
\glyph{production}  & I & I & I & I(1) & I    &      &      &      \\ \hline
\glyph{modulation}  & O & O & O &      &      & I(1) & I(1) & I(1) \\ \hline
\glyph{stimulation} & O & O & O &      &      & I(1) & I(1) & I(1) \\ \hline
\glyph{catalysis}   & O & O & O &      &      & I(1) & I(1) & I(1) \\ \hline
\glyph{inhibition}  & O & O & O &      &      & I(1) & I(1) & I(1) \\ \hline
\glyph{trigger}     & O & O & O &      &      & I(1) & I(1) & I(1) \\ \hline
\glyph{logic arc}   &   &   &   &      &      & O    & O    & O    \\ \hline
\glyph{equivalence arc} &   &   &  &   &      &      &      &      \\ \hline \hline
\end{tabular}

\subsection{Containment definition}
There are two EPN types which allows containment in SBGN: \glyph{compartment} and
\glyph{complex}. Next table describe relationship between EPN/PN elements of SBGN
and these two containers. Plus sign means that the element is able to be
containde within container. Empty cell means containment is not allowed.


\begin{tabular}{||c|c|c||}
\hline
$EPN/PN \backslash Containers$ & 
\glyph{compartment}& \glyph{complex} \\ \hline
\glyph{compartment} & + & +\\ \hline
\glyph{complex} &  & + \\ \hline
\glyph{macromolecule} & + & + \\ \hline
\glyph{simple chemical} & + & +   \\ \hline
\glyph{multimer} & + & +  \\ \hline
\glyph{complex}  & + & + \\ \hline
\glyph{unspecified entity} & + &  \\ \hline
\glyph{source/sink} & & \\ \hline 
\glyph{transition} & + &  \\ \hline
\glyph{omitted process} & + &  \\ \hline
\glyph{uncertain process} & + &  \\ \hline
\glyph{module} & + &   \\ \hline
\glyph{association} & + &  \\ \hline
\glyph{dissociation} & + &  \\ \hline
\glyph{and}  & + &   \\ \hline
\glyph{or} & + &   \\ \hline
\glyph{xor} & + &  \\ \hline
\glyph{not} & + &  \\ \hline
\end{tabular}


\subsection{Syntactic Rules}

Indicence matrix, defining main part of the syntax, is too permissive. 
Additional rules should be defined to make syntax definition more precise.

\begin{enumerate}
  \item EPNs. That rules are applicable to all EPNs (\ref{sec:EPNs})
  \begin{enumerate}
    \item If \glyph{macromolecule} has more than one \glyph{state variable}, 
    all \glyph{state variables} should have a name;
    \item All \glyph{state variables} of the \glyph{macromolecule} should have 
    different names;
    \item \glyph{Complex} should consists of different EPNs. If two or more 
    elementns of the complex are identical they should be replaced by multimer. 
    \item Identity includes not only name of the element but its state also.
  \end{enumerate}
  \item Sink/Source.
  \begin{enumerate}
    \item \glyph{source/sink} is allowed to have only one link attached to it. It
    could be either \glyph{consumption} or \glyph{production} link.
  \end{enumerate}
    \item Process. That rules are applicable to all PNs (\ref{sec:PNs})
  \begin{enumerate}
    \item PN should have nonzero number of \glyph{consumption} links.
    \item PN should have nonzero number of \glyph{production} links.
    \item All substrates of the transition should be different. If several 
    copies of the same EPN are involved in the process, cardinality label of 
    \glyph{consumption} arc should be used.
    \item All producs of the transition should be different. If several copies 
    of the same EPN are produced in the process, cardinality label of 
    \glyph{production} arc should be used.
    \item Once cardinality label set to one arc of the PN all other arcs should
    make their cardinality visible, even if it is undefined. In a case
    cardinality is undefined or unknown ``?'' should placed as cardinality label.
    \item The EPN is not allowed to be a substrate and product of the same 
    process. This rule is applicable to cloned EPNs as well.
    \item PN should have only one \glyph{Catalysis} arc connected to it. If
    there more than one catalyst is known for the process several PNs should be
    drawn. 
    \item PN should have only one \glyph{Trigger} arc connected to it. If
    there more than one trigger is known for the process several PNs should be
    drawn.  
  \end{enumerate}  
    \item \glyph{Association}
  \begin{enumerate}
    \item Composition of the \glyph{complex} or \glyph{multimer} produced by
    \glyph{association} should be identical to set of \glyph{association} substrates.
    \item If \glyph{asociation} produces \glyph{complex}, than number of 
    \glyph{consumption} arcs should be two or more.
    \item If \glyph{association} produces \glyph{multimer}, than the only one 
    \glyph{consumption} arc is allowed. In that case if substrate is not a
    \glyph{multimer}, then the number of monomers in a product \glyph{multimer}
    should be equal to cardinality of that arc. If substrate is another
    \glyph{multimer}, then cardinality of the consumption arc should be equal to
    ratio of number of monomers in product and in substrate \glyph{multimers}.
  \end{enumerate}  
    \item \glyph{Dissociation}
  \begin{enumerate}
    \item Composition of \glyph{complex} or \glyph{multimer} consumed by
    \glyph{dissociation} should be identical to set of products of the process.
    \item If \glyph{complex} is consumed by the \glyph{dissociation}, than the
    process should have two or more \glyph{production} arcs.
    \item If \glyph{multimer} is splitted by \glyph{dissociation} process, than
    one or more \glyph{production} arcs should be connected to the process node.
  \end{enumerate}  
  
  
\end{enumerate}

